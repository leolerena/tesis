%!TeX root = bass_serre.tex
\documentclass[tesis.tex]{subfiles}

%\newcommand{\ol}{\overline{}}
\newcommand{\ic}{independiente de contexto }
\newcommand{\APND}{automáta de pila no determinístico }
\newcommand{\APD}{automáta de pila determinístico }
\newcommand{\fg}{grupo finitamente generado }
\newcommand{\fp}{grupo finitamente presentado }
\newcommand{\vl}{virtualmente libre}
\newcommand{\WP}{\text{WP}(G, \Sigma)}
\newcommand{\deriva}{\overset{*}{\Rightarrow_{\cal G}}}
\newcommand{\cG}{ {\cal G} }
\newcommand{\cH}{ {\cal H} }
\newcommand{\Xm}{\widetilde X}


\begin{document}

\chapter{Teoría de Bass Serre.}

Introduciremos los resultados y definiciones más importantes de la teoría de Bass Serre. 
Las referencias clásicas que seguiremos son \cite{serre2002trees} y \cite{}.
En esta sección los grafos serán siempre conexos y dirigidos.
Dado un grafo $Y= (V(Y),E(Y))$ por cada arista $y \in E(Y)$ tendremos una designación $s(y) = P, t(y) = Q$ si la arista comienza en $P$ y termina en $Q$.
Denotaremos $\overline y$ la arista con asignación opuesta, esto es que $s(\ol y) = Q, t(\ol y) = P$.
Una \blue{orientación} de las aristas es una función $o:E(Y) \to \{ 0 ,1 \}$ tal que si $o(y)=1$ luego $o(\ol y)= 0$.

\begin{deff}
	Un \blue{grafo de grupos $\cal G$ sobre $Y$} está definido por lo siguiente:
	\begin{enumerate}
		\item Para cada vértice $P \in V(Y)$ tenemos un grupo $G_P$.
		\item  Para cada arista $y \in E(Y)$ tenemos un grupo $G_y$ tal que $G_y \le G_{t(y)}$.
		\item Para todo $y \in E(Y)$ tenemos un isomorfismo de $G_y$ a $G_{\overline y}$ que denotaremos por $a \mapsto a^{\overline y} $ tal que $(a^{\overline y})^y  = a$ para todo $a \in G_y$.
	\end{enumerate}
\end{deff}

En general para la definición de grafo de grupos no es necesario pedir para la condición \textbf{2} que haya una contención sino que alcanza con tomar un monomorfismo. 
Para facilitar las construcciones más en adelante supondremos que es un subgrupo pero los argumentos se pueden readaptar en el caso de no suponerlo.

\todo[inline]{Hacer ejemplitos básicos de grafos de grupos.}

Dado un grafo $Y = (V(Y), E(Y))$ llamaremos $F_{E(Y)}$ al grupo libre  generado por las aristas del grafo.

\begin{deff}
	Dado un grafo de grupos $\cal G$ sobre un grafo $Y = (V(Y), E(Y))$ podemos armarnos el siguiente grupo 
	\begin{equation*}
		F({\cal G}) = \ast_{P \in V(Y)} G_P \ast F_{E(Y)} / \langle \langle  R \rangle \rangle
	\end{equation*}
	donde $R = \{  \overline y = y^{-1}, \ ya^yy^{-1} = a^{\overline y} \}$ para $y \in E(Y), a \in G_y$. 
\end{deff}

\begin{obs}
	Las relaciones $R$ por las que dividimos anteriormente se pueden condensar en 
	\[
	R = \{  ya^y \overline y = a^{\overline y}  \}.
	\]
\end{obs}

\begin{deff} \label{def_pi1_arbol}
	Sea un grafo de grupos $\cal G$ sobre $Y$.
	Consideremos $T$ un árbol de expansión del grafo $Y$.
	\footnote{Como suponemos que $Y$ es conexo existen (posiblemente varios) árboles de expansión.}
	Nos armamos el siguiente \blue{grupo fundamental del grafo de grupos}
	\begin{equation*}
		\pi_1({\cal G}, T) = F({\cal G}) / \{ y \  | \ y \in E(T)  \}.
	\end{equation*}
\end{deff}

Esto es que para todas las aristas que aparecen en el árbol de expansión las identificamos con el $1$. 
Esta definición se puede ver que en el caso particular de un grafo coincide con la definición que tenemos del grupo fundamental de un espacio topológico.

\begin{ej}
	Sea un grafo de grupos $\cal G$ sobre un grafo $Y$ tal que $G_y = \{ 1 \}$ para todo $y \in E(Y)$.
	Consideremos una orientación $A$ para las aristas del grafo esto es que para cada par de vértices unido por una arista $y$ tenemos que $y \in A \iff \overline y \notin A$.
	El grupo fundamental $\pi({\cal G}, T)$ está generado por los elementos $G_P, P \in V(Y)$ y los elementos $g_y \in A \setminus (T \cap A)$.
	Esto es que nos queda el siguiente grupo
	\[
	\pi_1({\cal G}, T) = \ast_{P \in V(Y)} G_P \ast F
	\]
	donde $F$ es el grupo libre con base $A \setminus (T \cap A)$.
	Esto es que nos queda $\pi_1({\cal G}, T) \simeq \pi_1(Y) \ast_{P \in V(Y)} G_P$.
\end{ej}

\begin{ej}
	Si el grafo es un segmento en particular él mismo es el árbol de expansión puesto que es un árbol.
	De esta manera si $Y$ es el siguiente segmento de grupos,
	\[\begin{tikzcd}
		{G_P \ \ \bullet} && {\bullet \ \ G_Q}
		\arrow["G_y"{pos=0.6}, from=1-1, to=1-3]
	\end{tikzcd}\]
	entonces
	\[
	\pi_1({\cal G}, Y) = G_P \ast_{G_y} G_Q.
	\]
\end{ej}

Podemos dar otra definición de grupo fundamental pero está vez usando caminos así como lo hacemos para el grupo fundamental usual.

\medskip
Dados dos vértices $P,Q \in V(Y)$ denotaremos por $\Pi(P,Q)$ el conjunto de caminos de $P$ a $Q$.
De esta manera nos queda definido
\[
\Pi(P,Q) = \{  y_1 \dots y_k \ | \ s(y_1)=P, \ t(y_k) = Q, \ t(y_i) = s(y_{i+1})  \ \text{para} \ 1 \le i \le k \}
\]
tal que estos son subconjuntos en $F(\cG)$ si miramos a las aristas como elementos del grupo.
En particular podemos tomar $g_0y_1g_1 \dots g_{k-1}y_kg_k \in F(\cG)$ tales que
\[
g_i \in G_{s(y_i)}, \ \ g_k \in G_Q,
\]
A estos subconjuntos los denotaremos $\pi(\cG, P, Q)$. 
En particular para todo $P \in V(Y)$ tenemos que $\pi(\cG,P,P)$ es un subgrupo de $F(\cG)$ esto porque si hacemos el producto entre dos elementos de este subconjunto tenemos que
\begin{equation*}
	(g_0y_1g_1 \dots g_{k-1}y_kg_k ) \circ ( g'_0y'_1g'_1 \dots g'_{k-1}y'_kg'_k) =  g_0y_1g_1 \dots g_{k-1}y_k(g_kg'_0)y'_1g'_1 \dots g'_{k-1}y'_kg'_k
\end{equation*}
donde $g_kg'_0 \in G_P$ por lo tanto su producto está bien definido y en definitiva nos queda otro elemento de $\pi(\cG, P, P)$ tal como queríamos ver.


\begin{deff}
	\blue{El grupo fundamental de $\cG$ respecto a un punto de base $P$} se define como $\pi_1(\cG, P) = \pi(\cG,P,P)$.
\end{deff}

Notemos que en particular para esta construcción obtuvimos un subgrupo del grupo $F(\cal G)$ mientras que en el caso de la definición anterior \ref{def_pi1_arbol} obtuvimos un cociente.
Podemos ver que ambas definiciones son equivalentes porque son isomorfos como grupos.

\begin{teo}\label{teo_grp_fund_iso}
	$\pi_1({\cal G}, P)$ es isomorfo con $\pi_1({\cal G}, T)$.
\end{teo}
\begin{proof}
	Veamos que la composición de la inclusión $\iota: \pi_1( \cG ,P)  \to F(\cG)$ con la proyección $\pi: F(\cG) \to \pi_1(\cG, T)$ es un isomorfismo.
	
	Dados $P,Q \in V(Y)$ consideremos la geodésica $\alpha$ que los une sobre $T$.
	Si leemos la sucesión de aristas que recorre esta geodésica tenemos una palabra en $T(P,Q) \in F_{E(Y)}$ de manera que nos define un elemento en el grupo $F(\cG)$.
	Ahora definamos el siguiente morfismo (que depende del árbol de expansión que tomamos):
	
	\begin{align*}
		\tau: & F(\cG) \to \pi_1(\cG,P)  \\
		& \tau(y) = T[P,s(y)]yT[t(y),P] \ \ \text{para } \ y\in E(Y) \\
		& \tau(g) = T[P,Q] g T(Q,P) \ \  \text{para} \ Q \in V(Y), \ g \in G_Q
	\end{align*}
	
	Lo definimos sobre los generadores del producto libre y por como lo tomamos siempre nos devuelve un elemento de $\pi(\cG, P)$.
	Para ver que está bien definido debemos ver que cumple la relación $\tau(\overline y a^y y) = \tau (a^{\overline y})$ para toda arista $y \in E(Y)$.
	Esto vale porque justamente 
	\begin{align*}
		\tau(\overline y a^y y) & = T[P,s(\overline y)]\ol yT[t(\ol y),P] T[P,s(y)] a^y T[t(y),P] T[P,s(\overline y)]yT[t( y),P] \\
		& = T[P,s(\overline y)]  \ol y a^y y T[t( y),P] \\
		& = \tau (a^{\ol y}).
	\end{align*}
	Es un epimorfismo porque en particular todo elemento de $\pi_1(\cG, P)$ es un camino que termina y comienza en $P$ intercalado con elementos de los estabilizadores de los vértices que aparecen en el camino.
	De esta manera como $\tau(y)=1$ para todo $y \in E(T)$, notemos que pasa al cociente y existe $\ol \tau: \pi_{1}(\cG, T) \to \pi_1 (\cG, P)$ epimorfismo.
	
	Para terminar la demostración probemos que componiendo con $\nu$ nos queda la identidad.
	Si hacemos $\nu \circ \ol \tau$ notemos que 
	\begin{equation*}
		\nu \circ \ol \tau (a^y) = a^y, \ \ \nu \circ \ol \tau (y) = y, 
	\end{equation*}
	para $y \in E(Y) \setminus E(T)$ porque justamente estamos dividiendo por estas aristas. 
	Esto porque $T[P,Q]$ es un camino de aristas en el árbol de expansión por lo tanto sobre $\pi_1(\cG, T)$ son la identidad.
\end{proof}



\section{Casos particulares.}

En esta sección vamos entender como son los grupos fundamentales de algunos grafos de grupos cuando los grafos tienen algunas formas en particular. 
La idea, aparte de ejemplificar en unos casos en particular, es que más en adelante nos va a servir para reducir proposiciones sobre grafos finitos arbitrarios a grafos de estas formas.
Entonces probar resultados sobre otros grafos se va a reducir a la demostraciones que tengamos de estos otros casos bases más comprendidos.

\subsection{Segmentos y grupos amalgamados.}
Consideremos que nuestro grafo de grupos $\cG$ está dado sobre cierto segmento $Y$ de la siguiente pinta.

Calculemos el grupo fundamental de este grafo de grupos.
Como podemos tomar al árbol de expansión al mismo segmento entonces $\pi_1(\cG, T)$ resulta ser el grupo que tomamos libre sobre $G_P$ y $G_Q$ en el que identificamos al subgrupo $G_y$ de $G_P$ con el subgrupo isomorfo $G_{\overline y}$ de $G_Q$.
De esta manera el grupo que conseguimos es el grupo amalgamado $G_P \ast_{G_y} G_Q$. 

A continuación veremos un resultado que nos servirá para tener una escritura única y particular de cada palabra sobre los generadores de un grupo amalgamado.
\begin{prop}
	Toda palabra sobre el grupo amalgamado $G_P \ast_{G_y} G_Q$ se puede escribir de la siguiente forma:
	
\end{prop}
\begin{proof}
	\red{sorry}
\end{proof}
 
Esta forma para cada palabra la llamaremos la forma normal de $w$.
\subsection{Loops y grupos HNN.}

Si el grafo resulta ser un loop
\todo[inline]{Agregar grafiquito de un loop.}
entonces no tiene árbol de expansión de manera que esto nos dice que $F(\cG) \simeq \pi_1(\cG)$.
Notaremos por $a$ a cada elemento de $G_y$ mientras que notaremos por $\overline{a}$ a cada elemento del grupo isomorfo $G_{\ol{y}}$.
Sea $g$ el generador de $F_{y}$, es decir el correspondiente a la única arista de este grafo. 
En este caso las relaciones que tenemos en nuestro grupo son las siguientes
\[
	g^{-1}ag = \ol{a}  \  \ \ \text{para todo} \ a \in G_y.
\]   
De esta manera tenemos que una presentación de nuestro grupo es la siguiente:


Ahora veamos un resultado análogo al que demostramos anteriormente para grupos amalgamados que nos dirá una manera de escribir las palabras en estos grupos.
\begin{teo}[Britton]
	Toda palabra $w$ de un grupo $G$ de tipo HNN es tal que se puede escribir de la siguiente manera:
	\[
	...
	\]
	donde ...
\end{teo}
\begin{proof}
	.
\end{proof}
\section{Palabras reducidas.}

En esta sección vamos a caracterizar los elementos del grupo $F(\cG)$.

Sea $c=(y_1, \dots, y_n) \in \Pi(P,Q)$ algún camino entre dos aristas $P,Q \in V(Y)$ y consideremos $\mu = (r_0, \dots r_n)$ una sucesión de elementos tomados de manera que $r_i \in G_{s(y_i)}$ tal como hicimos para la definición de $\pi(\cG, P)$.
Llamaremos al par $(c, \mu)$ visto como elemento en $\ast_{P \in V(Y)}G_P \ast E(Y)$ a 
\[
(c,\mu) = r_0 y_0 r_1 y_1 \dots r_n y_n.
\]
Nos interesa saber bajo qué condiciones estas palabras son reducidas en el grupo $F(\cG)$.
Notaremos $|c,\mu|$ la imagen de esta palabra en el grupo $F(\cG)$.

\begin{deff}
	Una palabra $(c, \mu)$ es \blue{reducida} si satisface las siguientes dos propiedades:
	\begin{enumerate}[R1.]
		\item Si $n=0$ entonces $r_0 \neq 1$.
		\item Si $n \ge 1$ entonces $r_i \notin G_{y_i}$ para todo $i$ tal que $y_{i+1} = \ol y_{i}$.
	\end{enumerate}
\end{deff}
En particular si tomamos una palabra $(c, \mu)$ tal que el camino $c$ tiene backtracking por la propiedad \textbf{R2} tenemos que esta palabra no va a ser reducida.

Queremos ver que estas condiciones nos alcanzan para probar que estas palabras vistas en $F(\cG)$ sean distintas de la identidad.
Nuestro objetivo es el siguiente teorema:
\begin{teo}\label{teo_pal_red}
	Toda palabra $(c, \mu)$ reducida es tal que $|c,\mu| \neq 1$.
\end{teo}

En particular de este teorema obtenemos los siguientes corolarios de bastante utilidad.

\begin{coro}\label{coro_pal_red_1}
	Para todo $P \in V(Y)$ vale que $G_P \le F(\cG)$.
\end{coro}
\begin{proof}
	Es el caso que $c$ es el camino constante.
\end{proof}

\begin{coro}\label{coro_pal_red_2}
	Si $(c, \mu)$ es reducida y su longitud es al menos $1$ entonces $|c, \mu| \notin G_{P_0}$ donde $P_0$ es el origen del camino $c$.
\end{coro}
\begin{proof}
	Vamos a suponer que esto no es cierto y contradecir el teorema \ref{teo_pal_red}.
	Sea $c = (P_0y_1P_1\dots P_0)$.
	Si no fuera cierto tendríamos que $|c,\mu| = x \in G_P$ y podríamos tomarnos otra palabra reducida $(c,\mu')$ tal que $\mu' = (x^{-1}r_0, \dots, r_n)$ de manera que $|c,\mu'| = 1$.
	Sigue siendo una palabra reducida porque justamente por suposición tenemos que la longitud de $c$ es al menos $1$.
	Esto es una contradicción porque ninguna palabra reducida puede ser la identidad.
\end{proof}

\begin{coro}\label{coro_pal_red_3}
	Sea $T$ un árbol de expansión de $Y$ luego si $(c, \mu)$ es una palabra reducida tal que $c$ es un camino cerrado entonces $|c,\mu| \neq 1$ en $\pi_1(\cG, T)$. 
\end{coro}
\begin{proof}
	Por el teorema \ref{teo_pal_red} tenemos que $|c,\mu| \neq 1$ en el grupo $F(\cG)$ y como estos dos grupos son isomorfos por medio de la inclusión y la proyección al cociente, por el teorema \ref{teo_grp_fund_iso}, entonces esto termina de probar el resultado.
\end{proof}

Para esto emplearemos una construcción previa que nos ayude a probarlo recursivamente a partir de grafos cada vez más chicos.

Consideremos un grafo de grupos $\cG$ sobre un grafo $Y$. 
Tomemos $Y'$ un subgrafo conexo de $Y$ y restrinjamos el grafo de grupos $\cG$ a $Y'$. 
El grupo de este grafo de grupos lo denotaremos $F(\cG | Y')$.
Por inducción supongamos que vale el teorema \ref{teo_pal_red} para este grafo $Y'$.

\[\begin{tikzcd}
	& \color{rgb,255:red,214;green,153;blue,92}\bullet &  \color{rgb,255:red,214;green,153;blue,92} \bullet &&&  \color{rgb,255:red,214;green,153;blue,92} \bullet \\
	\bullet & \color{rgb,255:red,214;green,153;blue,92} \bullet &&&& \bullet \\
	\bullet &&&&&& \bullet \\
	& Y &&&& Y/Y' \\ 	
	\arrow[color={rgb,255:red,214;green,153;blue,92}, from=1-2, to=1-3]
	\arrow[color={rgb,255:red,214;green,153;blue,92}, from=1-2, to=2-2]
	\arrow[color={rgb,255:red,214;green,153;blue,92}, from=2-2, to=1-3]
	\arrow[from=2-1, to=1-2]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-2, to=3-1]
	\arrow[from=1-6, to=3-7]
	\arrow[from=2-6, to=1-6]
\end{tikzcd}\]
El subgrafo $Y'$ conexo lo distinguimos con este \textcolor{rgb,255:red,214;green,153;blue,92}{color}.

Sea $W = Y / Y'$  el grafo que obtenemos de contraer $Y'$ a un vértice que llamaremos $[Y']$. 
Como $Y'$ es conexo también lo es $W$.
Definamos un grafo de grupos sobre $W$.

\begin{enumerate}
	\item Los vértices son $V(W)= V(Y) \setminus V(Y') \cup \{ [Y'] \}$.
	\item Las aristas son $E(W) = E(Y) \setminus E(Y')$.
\end{enumerate}

Si las aristas no empiezan ni terminaban en $Y'$ dentro del grafo $Y$ al contraer el subgrafo siguen idénticas. 
En el otro caso las definimos para que terminen (o empiecen) en $[Y']$. Sea $y \in E(W)$ entonces,
\begin{equation*}
	s(y) = 
	\begin{cases}
	s(y),  & \text{si} \ s(y) \notin V(Y') \\ 
	[Y'], & \text{caso contrario}
	\end{cases}
\end{equation*}
y análogamente,
\begin{equation*}
	t(y) = 
	\begin{cases}
		t(y),  & \text{si} \ s(y) \notin V(Y') \\ 
		[Y']. & \text{caso contrario}
	\end{cases}
\end{equation*}


Entonces definamos el grafo de grupos $\cal H$ sobre el grafo conexo $W$ de la siguiente manera,
\begin{itemize}
	\item Si $P \in V(Y) \setminus V(Y')$, tomamos $H_P = G_P$;
	\item Si $P = [Y']$ entonces tomamos $H_P = F(\cG | Y')$.
	\item Si $y \in E(W)$ ponemos $H_y = G_y$ tal que como suponemos válido el resultado \ref{teo_pal_red} para $Y'$ tenemos que es un subgrupo.
\end{itemize}

Construyamos un morfismo de grupos $\beta:F(\cG) \to F(\cH)$.
Para eso primero lo definimos sobre los generadores.
Para todo $g \in G_P$ con $P \in V(Y)$ definimos,
\begin{equation*}
	\beta(g) = 
	\begin{cases}
		[g] \in H_P & \text{si} \ P \notin Y' \\
		[g] \in F(\cG | Y') & \text{si} \ P \in Y'  \\ 
	\end{cases}
\end{equation*}
y para toda arista $ y \in E(Y)$ definimos,
\begin{equation*}
	\beta(y) = 
	\begin{cases}
		y  & \text{si} \ y \notin E(Y') \\
		[y] \in F(\cG | Y') & \text{si} \ y \in E(Y')  \\ 
	\end{cases}
\end{equation*}

De manera que así como está definida cumple las relaciones porque $F(\cH)$ también las cumple y así vemos que pasa al cociente y así obtenemos que $\beta$ está bien definida.

\begin{lema}
	El morfismo de grupos $\beta:F(\cG) \to F(\cH)$ es un isomorfismo. 
\end{lema}
\begin{proof}
	Podemos construirnos un morfismo $\alpha:F(\cH) \to F(\cG)$ tal que sea su inversa.
	La construcción es análoga.
	
	Para todo $g \in H_P$ con $P \in V(W) \setminus [Y'] $ definimos,
	\begin{equation*}
		\alpha(g) = [g] \in G_P \ \ 
	\end{equation*}
	y para toda arista $ y \in E(W)$ tal que no empiece ni termine en $[Y']$ definimos,
	\begin{equation*}
		\alpha(y) = y  \ \ \ 
	\end{equation*}
	
	Finalmente sobre $F(\cG | Y')$ definimos de manera análoga mandando todo elemento $g \in G_P$ para para $P \in V(Y')$ a sí mismo en $F(\cG)$ e idénticamente para todas las aristas.
	Es claro que es un morfismo de grupos que a su vez es la inversa de $\beta$ anteriormente definida.
\end{proof}

La moraleja de este lema es que podemos tomar el grupo $F(\cG | Y')$ para un subgrafo $Y'$ conexo y después tomar el grupo $F(\cH)$ para el grafo resultante y es exactamente lo mismo que tomar $F(\cG)$ en el comienzo.

Para cada palabra $(c, \mu)$ del grafo de grupos $F(\cG)$ le vamos a asociar una palabra $(c', \mu')$ de $\cH$ tal que $\beta (|c,\mu|) = |c',\mu'|$.
La idea es reemplazar las partes de la palabra que involucren a $Y'$ con las respectivas en $F(\cG | Y')$.
Dados $ 1 \le i \le j \le n$ llamemos $c_{ij}$ al camino $(P_iy_i \dots y_{j-1}P_j)$ y $\mu_{ij}$ a los elementos $(r_i, \dots, r_j)$.
Si $c_{ij}$ está contenida en $Y'$ denotaremos por $r_{ij}$ al elemento correspondiente visto en $F(\cG | Y')$.
De esta manera lo que haremos es pensar en todos los subintervalos $[i_a,j_a]$ tales que el camino $c$ está dentro del subgrafo $Y'$.
Así tenemos subdividido al intervalo $[1,n]$ de la siguiente manera,
\[
	1\le i_1 \le j_1 < i_2 \le j_2 < \dots i_m \le j_m \le n.
\]
Donde en particular si miramos la palabra $c_{j_{a-1}i_a}$ notemos que es un camino por fuera de $Y'$ exceptuando su comienzo y su final.

Definimos la palabra $(c', \mu')$ sobre los generadores de $F(\cH)$ como:
\begin{itemize}
	\item $c' = (c_{j_1i_2} \dots, c_{j_{a-1}i_a},c_{j_{a}i_{a+1}} \dots, c_{j_{m-1}i_{m}})$
	\item $\mu' = (\mu_{1i_1}, r_{i_1j_2}, \dots, r_{i_mj_m}, \mu_{j_m n}   )$
\end{itemize}
donde tomamos la convención que $\mu_{1i_1}$ o bien $\mu_{j_m n}$ pueden ser la identidad si $i_1=1$ o bien si $j_m = n$.




Por como las construimos nos queda que $\beta(|c,\mu|) = |c',\mu'|$ tal como queríamos ver.
Veamos ahora que $\beta$ preserva las palabras reducidas. 
Esto nos permitirá trabajar en grafos de grupos cada vez más chicos a medida que vayamos contrayendo subgrafos conexos.

\begin{prop}\label{lema_pal_red_iso}
	Si $(c, \mu)$ es una palabra reducida para $F(\cG)$ entonces $(c', \mu')$ es reducida para $F(\cH)$.
\end{prop}
\begin{proof}
	Si la longitud de $c'$ es exactamente $0$ entonces es un camino constante en algún vértice $P' \in V(W)$. 
	En tal caso $\mu = (r_0)$ donde $r_0 \neq 1$.
	Si $P \in V(W) \setminus [Y']$ entonces como $H_P = G_P$ obtenemos que $r_0 \neq 1$ visto en $H_P$.
	En el otro caso usamos inducción pues nos queda que $r_0 \in F(\cG | Y')$ y por lo tanto es reducida usando el teorema \ref{teo_pal_red}.
	
	Supongamos ahora que la longitud de $c'$ es al menos $1$.
	Sea $c' = (P'_1w_1 \dots w_{n-1}P'_n)$ queremos ver que si $w_{k+1} = \ol{w_k}$ entonces $r_i \notin H_{y_k}$.	
	Sea $P' = t(w_k)$ entonces si $P' \neq [Y']$ esto vale porque justamente $(c, \mu)$ es reducida.
	Distinguimos dos casos si $P' = [Y']$:
	\begin{enumerate}[i)]
		\item En el primer caso $(w_{k},r'_k,w_{k+1})$ es tal que $w_{k} = y_i, w_{k+1} = \ol y_i$ para cierto $y_i$ que aparece en $c$. 
		Viéndolo en $F(\cG)$ tenemos que $r_k \notin G_{t(y_i)}$ porque la palabra $(c, \mu)$ es reducida por suposición.
		Como $G_{t(y_i)}$ es un subgrupo de $H_{[Y']} = F(\cG | Y')$ aplicando el corolario \ref{coro_pal_red_1} entonces la imagen de $r'_k$ no está en $H_{[Y']}$.
		
		\item En el otro caso tenemos que se corresponde a un camino dentro de $Y'$.
		Si $(w_{k},r'_k,w_{k+1})$ tiene la forma $(y_{i_a},r_{i_aj_a},y_{j_{a+1}})$ donde $r_{i_aj_a} = |c_{i_aj_a} \mu_{i_aj_a} | \in F(\cG | Y')$. 
		Dado que la longitud del camino $c_{i_aj_a}$ es al menos $1$ aplicando el resultado \ref{coro_pal_red_2} al grafo de grupos $\cG$ restringido al subgrafo $Y'$ vemos que $r_{i_aj_a} \notin G_Q$ si $Q =t(y_{i_a})$.
		Esto nos dice que en el grupo $F(\cH)$ tenemos que $r_{i_aj_a} \notin H_{t(w_k)} = F(\cG | Y')$.
	\end{enumerate}	
\end{proof}

Como último resultado previo veamos un lema que nos dice qué pasa cuando contraemos un subárbol de un árbol $Y$.

\begin{lema}\label{lema_subarbol_conexo}
	Si $Y$ es un árbol finito e $Y'$ es un subárbol de $Y$ entonces $W=Y/Y'$ es un árbol. 
\end{lema} 
\begin{proof}
	Debemos ver que $W$ es un grafo conexo y sin ciclos.
	
	Para ver que es \textit{conexo} tomemos dos vértices $w_1,w_2 \in V(W)$ y veamos de construir un camino entre ellos.
	Si ambos vértices se pueden unir por un camino $c$ en $Y$ tal que no interseca a $W$ podemos tomar ese mismo camino.
	Sino tomemos $c$ algún camino que los una y notamos que $c'$ tal como lo construimos anteriormente es un camino que los une en $W$.
	
	Para ver que \textit{no tiene ciclos} supongamos que $\sigma$ es un ciclo de este grafo.
	Así como en el caso anterior este ciclo necesariamente tiene que ser sobre el vértice contraído $[Y']$ caso contrario conseguiríamos un ciclo en el grafo $Y$ pero esto no es posible dado que es un árbol.
	Si miramos por medio del morfismo $\alpha$ definido en la proposición \ref{} obtenemos un camino $c$ en $Y$ tal que debe empezar y terminar en $Y'$. 
	Como por hipótesis $Y'$ es conexo existe un camino $c$ tal que conecta estos dos vértices. 
	Esto es una contradicción porque habríamos conseguido un ciclo sobre el grafo $Y$. 
\end{proof}


Finalmente estamos en condiciones de probar el resultado central de esta sección. 

\textbf{Demostración del teorema \ref{teo_pal_red}.}
Vamos a demostrar este resultado viéndolo para distintos casos de grafos.
	\begin{enumerate}
		\item El caso que $Y$ es un segmento.
		\[\begin{tikzcd}
			{P_{-1} \ \ \bullet} && {\bullet \ \ P_1}
			\arrow["y"{pos=0.6}, from=1-1, to=1-3]
		\end{tikzcd}\]
		El elemento $|c, \mu|$ es de la pinta $r_0y^{e_1}r_1y^{e_2}\dots y^{e_n}r_n$.
		Donde $e_{i} = -e_{i+1}$ para todo $i=1 \dots n$ y los elementos cumplen que $r_0 \in G_{P_{-e_i}}$ y $r_i \in G_{P_{e_i}} \setminus G_{y^{e_i}}$ dado que $(c, \mu)$ es una palabra reducida.
		El caso particular que nuestro camino es constante tenemos que $r_0 \neq 1$ porque vale \textbf{R1}.
		Para el otro caso, es decir el caso que el camino $c$ no es constante consideremos el morfismo sobreyectivo al cociente 
		\[
			\phi: F(\cG) \to G_{P_{-1}} \ast_{G_y} G_{P_1}
		\]
		donde $G_{P_{-1}} \ast_{G_y} G_{P_1} \simeq \pi_1(\cG, T)$ donde $T$ es el mismo segmento $Y$ en este caso. 
		Acá estamos usando que el grupo fundamental de un segmento es un grupo amalgamado.
		Dado que conocemos como son las palabras reducidas en los grupos amalgamados por \ref{} entonces vemos que $(c, \mu)$ no es la identidad porque justamente 
		\[
			\phi(|c,\mu|) = r_0 \dots r_n \neq 1
		\]
		por lo tanto como $\phi(|c,\mu|) \neq 1 $ esto implica que $|c,\mu| \neq 1$ tal como queríamos ver.
		
		\item El caso que $Y$ es un árbol. 
		Lo probamos usando inducción en la cantidad de vértices del grafo.
		Tomemos un segmento $Y'$ dentro del árbol donde ya sabemos que el resultado vale por el caso anterior.
		Por el lema recientemente probado \ref{lema_subarbol_conexo} vemos que el grafo $W = Y / Y'$ resulta ser un árbol y más aún podemos aplicarle la hipótesis inductiva dado que tiene menos vértices que $Y$. 
		De esta manera aplicando el paso inductivo obtenemos que vale este resultado para el grafo de grupos $\cH$ sobre $W$ por lo que $|c',\mu'| \neq 1$ y usando el lema \ref{lema_pal_red_iso} tenemos que $|c, \mu| \neq 1$.
		
		\item El caso que $Y$ es un bucle.
		Dado que en este caso el grupo $F(\cG)$ resulta ser una extensión de tipo HNN por lo visto en la sección anterior podemos aplicar el lema de Britton \ref{} que justamente nos muestra que esta palabra es distinta de la identidad en el grupo $F(\cG)$.
		
		\item El caso general.
		Lo probamos por inducción en la cantidad de vértices. 
		Para eso tomamos $Y'$ un segmento o bien un loop dentro de $Y$ y luego aplicamos el resultado a $Y/Y'$.
		Por inducción en este caso vale el resultado y luego volviendo a usar el lema \ref{lema_pal_red_iso} terminamos de probarlo para un grafo $Y$ conexo y finito arbitrario.
	\end{enumerate}


\section{Árbol de Bass Serre.}

Vamos a construirnos un revestimiento para un grafo de grupos arbitrario. 
Como el revestimiento universal de todo grafo es un árbol obtendremos un resultado similar en este caso.

Dado $\cG$ un grafo de grupos sobre un grafo $Y$ conexo tomemos un árbol $T$ de expansión de este grafo.
Consideremos también $A$ una orientación de las aristas del grafo $Y$ de manera que $e(y)=0$ si $y \in A$ mientras que $e(y)=1$ si $y \notin A$.
Dada una arista $y \in E(Y)$ denotaremos por $|y|$ a la arista $y$ o $\ol{y}$ tal que está en la orientación $A$.
Llamaremos $g_y$ al elemento de $F(\cG)$ correspondiente al generador $y \in E(Y)$ porque vamos a necesitar diferenciar elementos del grupo con las aristas propiamente dichas del grafo.

Queremos construirnos un grafo $\Xm$ tal que tenga las siguientes propiedades:

\begin{enumerate}
	\item Una acción de $\pi_1(\cG, T)$ en $\Xm$.
	\item Un morfismo de grafos sobreyectivo $p:\Xm \to Y$. 
	\item Unas secciones de los vértices de $Y$ en los de $\Xm$ e idénticamente secciones en las aristas.
\end{enumerate}

A nuestras secciones las vamos a denotar de manera que para todo vértice $P \in Y$ tendremos un $ \widetilde P \in V(\Xm)$.
Mirando la acción de $\pi_1(\cG, T)$ sobre $\Xm$ nos gustaría que el estabilizador respecto a $\widetilde P$ sea el mismo que el estabilizador de $P$ en el grafo de grupos $\cG$. 
Para esto podemos definir directamente para que $\widetilde P \simeq \pi_1(\cG, T) / G_P$.
Análogamente para todas las aristas de nuestro grafo queremos que el estabilizador sea isomorfo al subgrupo $G_y$ dentro de $G_{t(y)}$.
Llamemos a los estabilizadores $\pi_{\widetilde P}$ y $\pi_{\widetilde y} $ respectivamente para diferenciarlos. 
A su vez diferenciaremos por $\widetilde P$ a la imagen de $1$ dentro de los cosets e idénticamente lo haremos para $\widetilde y$. 

Usando estas condiciones tenemos que
\begin{equation*}
	V(\tilde X) = \coprod_{P \in V(Y)} \pi_1(\cG, T) / G_P, \ \  E(\tilde X) = \coprod_{y \in E(Y)} \pi_1(\cG, T) / G_y
\end{equation*}

para obtener un grafo nos queda definir como son los trasladados de aristas por medio de $g \in \pi_1(\cG, P)$.
Definimos así las siguientes operaciones sobre el grafo $\tilde X$,
\begin{enumerate}[(a)]
	\item $\overline{g \tilde y} = g \tilde{\ol y}$;
	\item $s(g \tilde y) = g g_y^{-e(y)} \widetilde{s(y)}$
	\item $t(g \tilde y) = g g_y^{1-e(y)} \widetilde{t(y)}$
\end{enumerate}

Debemos ver que así como están definidas resultan ser consistentes estas definiciones.
En el ítem \textbf{(a)} estamos definiendo como son las aristas con orientación opuesta. 
Por ahora tenemos definidas las aristas correspondientes a $\ol y$ de manera disjunta a las que están definidas correspondientes a $y$.
Para ver la validez de esta definición usamos que si $h\widetilde{\ol y} = g\widetilde{\ol y}$ entonces esto sucede si y solo sí $h\pi_{\widetilde{\ol y}} =g\pi_{\widetilde{\ol y}} $ pero justamente como $\pi_{\widetilde{\ol y}} = \pi_{y} $ por como definimos a estos grupos por lo tanto resultaban provenir de la misma arista del grafo $\tilde X$.

Para probar que es válida la definición de \textbf{(b)} veamos que si tomamos dos representantes distintos de alguna coclase donde comienza la arista va a ser en el mismo vértice.
En definitiva debemos ver para $h \in G_y$ que valga la siguiente igualdad,
\[
	hg_y^{-e(y)} \widetilde{s(y)} = g_y^{-e(y)} \widetilde{s(y)}
\] 
y esto recae en ver la siguiente igualdad que es básicamente la siguiente inclusión que es parecida a la relación que tenemos en este grupo,
\[
	g_y^{e(y)}\pi_{\tilde y}g_y^{-e(y)} \subset G_{\widetilde{s(y)}}.
\]
Pensemos en los dos casos posibles dependiendo de si la arista está en la orientación elegida o no lo está,
\begin{itemize}
	\item Si $e(y) = 0$ entonces $|y| = y$ y por como lo definimos tenemos que $\pi_{\tilde y} = G_{y}$ es tal que al conjugarlo por $g_y$ nos queda un elemento de $G_{\ol y}$ y tenemos que vale la inclusión $G_{\ol y} \subset G_{s(y)}$ dado que $t(\ol y) = s(y)$ para todo $y \in E(Y)$.
	\item Si $e(y) = 1$ entonces tenemos la siguiente situación
	\[
		\pi_{\tilde y} \subseteq G_{\widetilde{s(y)}}	
	\] 
	y para probar esto usamos la definición de estos grupos porque $\pi_{\tilde y} = G_{\ol y}$ dado que esta arista no está en la orientación.
	Usando nuevamente que $s(y) = t(\ol y)$ obtenemos lo que queríamos probar.  
\end{itemize}

Finalmente la definición \textbf{(c)} es válida usando lo anteriormente demostrado y reemplazando $y$ por $\ol y$.

\medskip

Por la construcción que hicimos nos queda que $\tilde X / \pi_1(\cG, T) \simeq Y$.
Por otro lado para todo $y \in E(T)$ tenemos que $g_y=1$ por lo que usando las definiciones de las aristas tenemos que $s(\tilde y) = \widetilde{s(y)}$ y similarmente $t(\tilde y) = \widetilde{t(y)}$.
Esto nos permite definirnos un \emph{levantado} $\widetilde{T}$ del árbol $T$ dado por mandar $P \mapsto \tilde P$ para todo $P \in V(Y)$ y para las aristas mandar $y \mapsto \tilde y$. 

\begin{teo}[Serre]
	El grafo $\Xm$ es un árbol.
\end{teo}
\begin{proof}
	Debemos ver dos cosas: que es conexo y que no tiene ciclos.
	
	Empezamos probando que el grafo es conexo.
	Dada una arista $\tilde y$ notemos que bien $s(\tilde y) = \widetilde{s(y)}$ o bien que $t(\tilde y) = \widetilde{t(y)}$.
	Si tomamos el árbol $\tilde T$ éste va a tener como vértices al comienzo o al final de esta arista $\ol y$.
	De esta manera como $\tilde T$ es conexo y si le agregamos las aristas $\tilde y$ que son conexas e intersecan a $\tilde T$ entonces obtenemos un grafo conexo $W$.
	Dado que toda arista $\tilde y$ está en $W$ y que $\pi_1(\cG)$ actúa sobre este árbol tenemos que $\pi_1(\cG) \cdot W = \tilde X$.
	El grupo $\pi_1(\cG)$ está finitamente generado por todos los elementos $g \in G_P$ para todo $P \in V(Y)$ y por los elementos $g_y$ para toda arista $y \in E(Y)$.
	Llamemos a este conjunto de generadores $S$, luego lo que tenemos es que vale la siguiente igualdad de conjuntos,
	\[
		\tilde X = \bigcup_{g \in \pi_1(\cG)} gW = \bigcup_{g=s_1 \dots s_n} \bigcup_{i=1 \dots n} s_{1}\dots s_{i} W  \cup W 
	\]  
	donde estamos tomando la unión de todos los elementos de $G$ como la unión de palabras indexadas por su longitud $n$ y todos los trasladados de $W$ por medio de subpalabras de $g$.
	Probaremos por inducción en la longitud de $g=s_1\dots s_n$, visto sobre el conjunto de generadores $S$, que 
	\[
		s_1\dots s_n W \cap s_1 \dots s_{n-1}W \neq \emptyset	
	\] 
	por lo tanto la unión 
	\[
	W_g = W \cup s_1W \cup \dots \cup s_1\dots s_{n}W
	\]
	sería conexa y de esta manera veríamos que $\tilde X$ es conexo tomando la unión sobre todas las palabras del grupo dado que todos los $W_g$ son conexos e intersecan a $W$ un conexo.
	Para el caso base debemos ver dos casos.
	\begin{enumerate}
		\item Si $g=g_y$ para alguna arista $y \in E(Y)$.
		En este caso dependiendo si $y \in A$ o no obtenemos los siguientes dos casos,
		\begin{align*}
			s(g_y \tilde y) &= s(\tilde y)   & \text{si} \ e(y) = 1 \\
			t(g_y \tilde y) &= t(\tilde y)   & \text{si} \ e(y) = 0 
		\end{align*}
		De esta manera $g_yW \cap W = \emptyset$.
		\item Si $g \in G_P$ para algún $P \in V(Y)$ entonces $g\tilde P = \tilde P \in V(W)$ por lo tanto $gW \cap W \neq \emptyset$. 
	\end{enumerate} 
	%Esto se debe a que $W$ lo es y trasladamos por un elemento del grupo y sigue siendo conexo.
	Ahora para el paso inductivo sigamos con la suposición de que es válido para palabras de longitud no mayor $n-1$. 
	Queremos verlo para $s_1\dots s_n$ y esto lo podemos hacer notando que 
	\[
	s_1(s_2 \dots s_n) W \cap s_2 \dots s_{n} W \neq \emptyset 
	\]
	donde usamos la hipótesis inductiva sobre $s_2 \dots s_n W$ que es una palabra de longitud $n-1$ y que al trasladar por $s_1$ lo que está en la intersección está en la intersección de los trasladados.
	Vimos así que el grafo $\tilde X$ es conexo porque lo escribimos como unión de conexos que se intersecan de a pares dado que todos los $W_g$ intersecan a $W$ para todo $g \in \pi_1(\cG)$.
	
	Veamos ahora que no tiene ciclos.
	Probaremos la siguiente proposición equivalente, para todo $n \in \NN$ no existe camino cerrado de longitud $n$ sin backtracking.
	Sea $\tilde c$ un camino sobre $\tilde X$ con estas propiedades. 
	Queremos llegar a un absurdo.
	Sean las aristas de este camino $\tilde c = (s_1\tilde{y_1}, s_2 \tilde{y_2}, \dots, s_n \tilde{ y_n})$.
	Si miramos la proyección de los vértices tenemos una sucesión de vértices $(P_0, \dots, P_n)$ donde $P_n = P_0$ dado que el camino es cerrado.
	Introduzcamos la siguiente notación: sea $e_i = e(y_i)$ y sea $g_i = g_{y_i}$.
	Al ser $\tilde c$ un camino cerrado valen las siguientes igualdades,
	\begin{align*}
		t(s_n\tilde y_n) &= s_ng_n^{e_n - 1}\tilde{P_0} = s_1g_1^{-e_1} \tilde{P_0} = s(s_1\tilde{ y_1}) \\ 
		\vdots \ \ \  &= \ \ \ \ \    \vdots\ \ \ \ \ \ \ \ \ \ \ \ \ \    \vdots \\
		t(s_{n_1}\widetilde{ y_{n-1}}) &= s_{n-1}g_n^{e_{n-1} - 1}\tilde{P_n} = s_ng_n^{-e_n} = s(s_n\tilde{P_n} )  
	\end{align*}
	de manera que considerando $r_i \in G_{P_i} = \pi_{\tilde{ P_i}}$ tal que $r_i = s_ig_i^{e_{i-1}} s_{i+1}^{-1} g_{i+1}^{-e_{i+1}}$ y nombrando a $q_i = s_ig_i^{-e_i}$ 
	podemos reescribir las igualdades anteriormente obtenidas de la siguiente manera,
	\begin{align*}
		q_1 &= q_ng_nr_n \\
		q_2 &= q_1g_1r_1 \\
		\vdots & \ \ \ \vdots \\
		q_n &= q_{n_1}g_{n-1}r_{n-1} 
	\end{align*}
	Más aún usando cada ecuación para reescribirla en la anterior obtenemos que,
	\begin{equation*}
		g_1r_1 = q_1^{-1} q_2 = \dots = q_n^{-1}q_1
	\end{equation*}
	de modo que multiplicando todo de forma telescópica nos termina quedando lo siguiente cuando se nos cancelan todos los $q_i$,
	\begin{equation*}
		g_1r_1\dots g_nr_n = 1.
	\end{equation*} 
	
	Para llegar a la contradicción veamos que esto que obtuvimos viene de una palabra reducida de manera que no podría ser la identidad.
	Sea la palabra $(c, \mu)$ para $F(\cG)$ dada por el camino $c$ anteriormente definido y la sucesión $\mu = (1,r_1, \dots, r_n)$.
	Solo nos queda ver que efectivamente es una palabra reducida. 
	Para eso debemos chequear que se cumpla la condición \textbf{R2} de \ref{} ya que suponemos que tiene longitud al menos $1$.
	
	Supongamos que existe $i$ tal que $y_{i+1} = \ol{y_i}$ por lo que $g_{i+1} = g_{i}$ y $e_{i+1} = 1 - e_i$.
	Queremos ver que para ese mismo $i$ vale que $r_i \notin G_{y_i}$.
	Para eso miramos la ecuación que teníamos 
	\[
		q_is_ir_i = q_{i+1}
	\]
	de manera que si desarmamos las definiciones y pasamos de lado obtenemos la siguiente igualdad
	\[
		r_i = g_i^{e_i - 1} (s_i^{-1} s_{i+1}) g_i^{1-e_i}
	\]
	esto es lo mismo que ver que 
	\[
		s_i^{-1}s_{i+1} \notin g_i^{1-e_i}G_{y_i} g_i^{e_i - 1}.
	\]
	El grupo de la derecha es justamente lo que definimos como $\pi_{y_i}$.
	Entonces debemos ver que $s_i\pi_{y_i} \neq s_{i+1} \pi_{y_i}$ pero esto vale porque por como definimos las aristas opuestas del grafo $\tilde X$ y por como tomamos a $y_i$ tenemos que 
	\[
	\ol{s_{i+1} \widetilde{y_{i+1}}} = s_{i+1} \widetilde{\ol y_i} 
	\]
	pero esto es una contradicción porque al camino original $\tilde c$ lo habíamos tomado sin backtracking.
	
	Para concluir notemos que la palabra $(c, \mu)$ cumple las hipótesis del resultado \ref{coro_pal_red_3} dado que es camino cerrado no trivial y es una palabra reducida por lo tanto $|c, \mu| \neq 1$ visto en $\pi_1(\cG, T)$ y esto contradice lo anteriormente obtenido.
\end{proof}


\begin{deff}
	El grafo $\tilde X$ es el \blue{árbol de Bass Serre} del grafo de grupos $\cG$ sobre un grafo conexo $Y$.
\end{deff}

%\begin{ej}
%	Hacer un ejemplo así como hice antes.
%\end{ej}
%
%Dar conexión con la idea topológica de un revestimiento de un grafo..

\section{Acciones de grupos sobre árboles.}

Sea $G$ un grupo \fg actuando sobre $X = (V(X),E(X))$ un grafo conexo tal que su acción es sin inversiones.

Consideremos el grafo $Y = X/G$ tal que está dado por los siguientes vértices y aristas.

Veamos ahora de tomar representantes para cada uno de los vértices y aristas de $Y$ en el grafo $X$.
Para tomar las aristas las vamos a elegir de esta manera,

Nos armamos un grafo de grupos sobre $Y$ tal que tiene a los siguientes grupos.

Construcción del morfismo de grupos $\varphi$.

\begin{lema}
	El morfismo de grupos $\varphi$ es inyectivo sobre los grupos $G_P \le \pi_1(\cG, P)$.
\end{lema}

\begin{prop}
	El morfismo de grupos $\varphi$ es sobreyectivo.
\end{prop}


Tenemos un morfismo de grafos $\psi:\tilde X \to X$ definido de la siguiente manera.
Ver buena definición.

\begin{deff}
	Un morfismo de grafo $\phi: X \to Y$ es una asignación..
\end{deff}

\begin{deff}
	Un morfismo de grafos $\phi:X \to Y$ se dice localmente inyectivo si..
\end{deff}

\begin{lema}
	Sea $\phi:X \to Y$ morfismo de grafos localmente inyectivo tal que $Y$ es un árbol y $X$ es conexo entonces resulta que $\phi$ es inyectivo.
\end{lema}
\begin{proof}
	Hacer.
\end{proof}

\begin{prop}
	$\psi: \Xm \to X$ es un epimorfismo de grafos localmente inyectivo.
\end{prop}
\begin{proof}
	Primero probemos que es un morfismo de grafos.
	
	Es un epimorfismo porque $\varphi$ es un epimorfismo de grupos.
	
	Veamos que es localmente inyectivo. 
	Sea 
\end{proof}

El siguiente resultado nos da la estructura de un grupo que actúa sobre un grafo conexo sin inversiones de aristas. 
Es el resultado central de la teoría de Bass Serre.

\begin{teo}[\cite{serre2002trees}]\label{teo_Serre}
	Sea $G$ un grupo actuando en grafo conexo $X$ sin inversiones de aristas y sea $\cal G$ el grafo de grupos asociado sobre $Y = X / G$.
	Consideremos $T$ un árbol de expansión de $Y$, $\psi: \Xm \to X$ y $\varphi: \pi_1({\cal G}, T) \to G$ luego las siguientes afirmaciones son equivalentes.
	\begin{enumerate}[(a)]
		\item el grafo $X$ es un árbol;
		\item el morfismo $\psi: \Xm \to X$ es un isomorfismo de grafos;
		\item el morfismo $\varphi:\pi_1({\cal G}, T) \to G$ es un isomorfismo de grupos.
	\end{enumerate}
\end{teo}

\begin{proof}	
		 La implicación \textbf{a $\Rightarrow$ b} la hacemos usando el lema \ref{}.
		 Para ver \textbf{b $\Rightarrow$ a} usamos que $\Xm$ es un árbol por lo tanto $X$ al ser isomorfo también es un árbol.
		 
		 Probemos \textbf{b $\Rightarrow$ c}. 
		 Para eso notemos que al ser $\varphi$ sobreyectivo nos alcanza con ver que es inyectivo.
		 Si $g \in \pi_1({\cal G}, T)$ y $g \neq 1$ tal que $\varphi(g)= 1$ entonces necesariamente $g \notin G_P$ por el lema anterior \ref{} dado que la restricción a estos subgrupos es inyectiva.
		 Esto nos dice que $g G_P P \neq G_P P$ dado que los cosets $gG_P$ y $G_P$ son distintos. Por como definimos a $\psi$ tenemos que 
		 \[
		 \psi (gG_P P) = \varphi(g) P  = \psi(G_P P)
		 \] 
		 pero esto contradice que $\psi$ sea un isomorfismo.
		 
		 Finalmente probemos \textbf{c $\Rightarrow$ b}. 
		 Para esto como $\psi$ es sobreyectivo nos alcanza con ver que es inyectivo.
		 Sean $gG_PP, hG_QQ \in V(\Xm)$ tales que $\psi(gG_PP) = \psi(hG_QQ)$.
		 Por la definición del morfismo $\psi$ obtenemos que 
		 \[
		 	\varphi(g)P = \varphi(h)Q
		 \]
		 pero esto nos diría que $P = Q$ dado que ambos son representantes de las órbitas de la acción de $G$ sobre el árbol $T$. 
		 Por otro lado obtenemos que $\varphi(g h^{-1}) P  =  P$ y así $\varphi(gh^{-1}) \in G_P$. 
		 Como $\varphi$ es un isomorfismo y en particular es inyectiva restringida al subgrupo $G_P$ por el lema \ref{} deducimos que $gh^{-1} \in G_P$.
		 Así ambos cosets son idénticos $g G_P = h G_P$ y por lo tanto vimos que los dos vértices son idénticos $gG_PP  = hG_QQ$ y de esta manera probamos que $\psi$ es inyectiva.
\end{proof}

Como corolarios obtenemos una caracterización para los grupos libres que usaremos varias veces y que es una herramienta fundamental de la teoría geométrica de grupos.

\begin{coro}
	Un grupo $G$ es libre si y solo sí $G$ actúa libremente sobre un árbol sin inversiones de aristas. 
\end{coro}
\begin{proof}
	Si $G$ es libre entonces su grafo de Cayley lo podemos tomar como un árbol y usamos que actúa libremente sobre él sin invertir aristas.
	
	Para la vuelta usamos \ref{teo_Serre} porque es isomorfo a $\pi_1(\cG, T)$ y este grupo es libre por ser el grupo fundamental de un grafo dado que los estabilizadores son triviales por hipótesis.
\end{proof}

\begin{coro}
	Dado $G$ un grupo libre todo subgrupo $H \le G$ resulta ser libre.
\end{coro}
\begin{proof}
	H actúa sin inversiones y libremente sobre el mismo árbol que actúa $G$.
\end{proof}

Otra consecuencia de este teorema de Serre es un resultado obtenido por Karass, Pietrowski y Solitar que nos da una cota de qué tan grande puede ser un subgrupo libre dentro de un grupo fundamental de un grafo finito de grupos finitos.
Este resultado generaliza la fórmula de Schreier para subgrupos libres.


Primero probamos el siguiente lema sobre grupos libres que nos va a ayudar en la demostración de esta fórmula.

\begin{lema}\label{lema_libre_torsion}
	Todo grupo libre \fg no tiene torsión.
\end{lema}
\begin{proof}
	Como todo grupo libre es tal que su grafo de Cayley se puede tomar como un árbol si tuviera torsión tendría un ciclo contradiciendo que es un árbol.
\end{proof}


\begin{prop}\cite{karrass1973finite}\label{prop_karrass_formula}
	Sea $\cal G$ un grafo de grupos finito con grupos sobre los vértices finitos.
	Sea $G = \pi_1 ({\cal G}, T)$ y sea $F$ un subgrupo libre de $G$ de índice finito con rango $r(F)$.
	Luego la siguiente fórmula vale:
	
	\begin{equation*}
		\frac{r(F) - 1}{(G:F)} = \sum_{y \in E(Y)} \frac{1}{2 \cdot |G_y|} - \sum_{P \in V(Y)} \frac{1}{|G_P|}.
	\end{equation*}
\end{prop}
\todo[inline]{Escribir mejor lo de los dobles cosets del final.}
\begin{proof}
	Sea $\tilde X$ el árbol de Bass Serre para este grafo de grupos $\cG$.
	Notemos que $F$ no interseca a ningún subgrupo de $G$ que sea isomorfo a $G_P$ para ningún $P \in V(Y)$. 
	Esto porque el grupo $F$ es libre y $G_P$ es finito por lo tanto la intersección tendría torsión pero por el lema \ref{lema_libre_torsion} ningún grupo libre tiene torsión.
	De esta manera $F$ es isomorfo al grupo fundamental de $\Xm / F$ con todos los grupos de los vértices triviales justamente porque los estabilizadores lo son.
	
	Dado que $\tilde X$ es un árbol estamos en las hipótesis para usar \ref{teo_Serre} y de esta manera obtenemos que $F \simeq \pi_1 (\widetilde X / F)$.
	Usando esto calculemos el rango del grupo libre contando todas las aristas que no pertenezcan a un árbol de expansión $T'$ del grafo $\Xm / F$.
	Recordemos que al ser un árbol generador tenemos que $\tfrac{1}{2}|E(T')| = |V(\Xm / F)| - 1$. 
	
	\begin{align*}
		r(F) &= \frac{1}{2} (|E(\Xm / F)| - |E(T')|) \\
		&= \frac{1}{2} |E(\Xm / F)| - |V(\Xm / F) | - 1
	\end{align*}

	donde multiplicamos por $\tfrac{1}{2}$ porque todas las aristas las contamos una vez por cada una de las dos orientaciones que tienen.
	
	Finalmente para obtener la fórmula que queremos probar tenemos que usar como está construido el árbol de Bass Serre $\Xm$.
	\begin{equation*}
		|V(\Xm / F)| = \sum_{P \in V(X)} |(G/G_P)/F|
	\end{equation*}
	y acá usamos que que la cantidad de cosets de $(G/G_y)/F$ es la misma que hay en $(F / G)/G_y$
	por lo tanto 
	\begin{equation*}
		|V(\Xm / F)| = \sum_{P \in V(X)} \dfrac{(G:F)}{|G_y|}
	\end{equation*}
	Obtenemos una expresión análoga para las aristas y así terminamos de probar la validez de la fórmula.
\end{proof}

%\begin{teo}
%	Sea $\cal G$ un grafo de grupos sobre un grafo finito $Y$ con grupos \fg en los vértices.
%	Entonces $\pi_1(\cal G)$ es \fg si y solo sí todos los grupos de los vértices lo son.
%\end{teo}
%
%\begin{proof}
%\end{proof}

Finalmente podemos probar que grupo fundamental de un grafo de grupos finito con grupos finitos es es virtualmente libre. 
Antes de probar esto necesitamos un lema sobre acciones en conjuntos finitos.

\begin{lema}\label{lema_acciones_finitas}
	Sea $G$ un grupo que actúa libremente sobre un conjunto finito $X$ de dos maneras distintas $\alpha, \beta : G \to S(X)$. 
	Entonces debe existir $\varphi \in S(X)$ tal que para todo $g \in G$ valga que 
	\[
	\alpha (g) = \varphi^{-1} \circ \beta(g) \circ \varphi.
	\]
\end{lema}
\begin{proof}
	Tomamos representantes para cada acción $R,S \subseteq X$ tales que
	\[
		\bigsqcup_{r \in R} \alpha(G) (r) = \bigsqcup_{s \in S} \beta(G) (s)
	\]
	donde la unión es disjunta como órbitas de esta acción. 
	Como ambas acciones son libres resulta que $\alpha(G)(r)$ y $\beta(G)(s)$ tienen cardinal exactamente $|G|$ usando que $X$ también es finito.
	De esta manera vemos que $|R| = |X| / |G| = |S|$ por lo tanto existe una biyección $\varphi$ entre ambos conjuntos que la extendemos a todo $X$ de la siguiente manera,
	\[
		\varphi (\alpha(g) r) = \beta(g)  s
	\]
	siempre y cuando $\varphi(r) = s$. 
	Esta biyección cumple todo lo que queríamos.
\end{proof}


\begin{teo}\cite{karrass1973finite}
	Sea $\cal G$ un grafo de grupos sobre un grafo finito $Y$ con grupos finitos en los vértices.
	Entonces $\pi_1(\cal G)$ es un \fg virtualmente libre.
\end{teo}
\begin{proof}
	Dado que el grafo $Y$ es finito y los grupos $G_P$ para todo $P \in V(Y)$ también son finitos podemos tomarnos $X$ un conjunto finito tal que $|G_P| $ divida a $|X|$ .
	
	Para cada $P \in V(Y)$ podemos armarnos una acción libre de $G_P$ en $X$. 
	Esto nos da un monomorfismo $G_P \to S(X)$.
	A su vez por cada grupo $G_y$ con $y \in E(Y)$ obtenemos dos acciones libres sobre $X$ dependiendo con qué inclusión lo estamos mirando.
	Por el lema \ref{lema_acciones_finitas} podemos elegirnos para cada $y \in E(Y)$ alguna $\varphi_y \in S(X)$ tal que haga conmutar al siguiente diagrama
	\[\begin{tikzcd}
		& {G_{s(y)}} && {S(X)} \\
		{G_y} \\
		& {G_{t(y)}} && {S(X)}
		\arrow["\sigma", from=1-2, to=1-4]
		\arrow["\tau", from=3-2, to=3-4]
		\arrow[hook, from=2-1, to=1-2]
		\arrow[hook', from=2-1, to=3-2]
		\arrow["\varphi_y", from=1-4, to=3-4]
	\end{tikzcd}\]
	Para la arista con orientación opuesta tomamos $\varphi_{\ol y} = \varphi_y^{-1}$.
	De esta manera tenemos un morfismo de grupos definido sobre el grupo libre $\ast_{P \in V(Y)} G_P \ast E(Y)$.
	Por como tomamos a $\varphi_y$ y como hace conmutar al diagrama tenemos que $\varphi_{\ol y} \circ \sigma \circ \varphi_y = \tau$.	
	Usando la definición del grupo $F(\cG)$ tenemos un morfismo de grupos $h: F(\cG) \to S(X)$ tal que la restricción a $G_P$ es inyectiva para todo $P \in V(Y)$.
	Si fijamos $P \in V(Y)$ y consideramos el subgrupo normal de $\pi_1(\cG, P)$ 
	\[
	F = \{  g \in \pi_1(G,P) \ | \ h(g) = 1  \}
	\]
	entonces por como lo consideramos tenemos que $F \cap G_Q = \{ 1 \}$ para todo $Q \in V(Y)$.
	Esto nos dice que el grupo $F$ actúa libremente sobre el árbol de Bass Serre de nuestro grafo de grupos $\cG$.
	A su vez como $F$ es un subgrupo de $\pi_1 (\cG, P)$ tenemos que actúa sin inversiones.
	Estamos en condiciones de usar el teorema de Serre \ref{teo_Serre} y así obtenemos que este grupo debe ser libre. 
	
	Por lo visto obtuvimos que $F$ es un subgrupo libre de $\pi_1(\cG, P)$ y queremos ver que tiene índice finito.
	Para eso notemos que al ser $|X| < \infty$ entonces $|S(X)| < \infty$ y como $S(X) \simeq \pi_1(\cG, P) / F$, por la propiedad universal del cociente, entonces $(\pi_1(\cG, P) : F) < \infty$ tal como queríamos ver.
	
	Finalmente notemos que por \ref{prop_karrass_formula} el grupo $F$ es un \fg tal como queríamos ver.
\end{proof}



\section{Productos semi directos.}

En esta sección vamos a refinar los resultados obtenidos anteriormente para ver que los grupos fundamentales de grafos finitos de grupos finitos y por lo tanto los grupos virtualmente libres se pueden meter dentro de un producto semidirecto $F Q$ donde $F$ es un grupo libre y $Q$ es un cociente finito de $G$.
La referencia de esta sección es el paper \cite{} que a su vez se basó en los métodos del paper de Dahmani-Guirardel.

\begin{prop}
	
\end{prop}
\begin{proof}
	\red{ sorry}
\end{proof}

\begin{ej}
	Ejemplo de $SL_2(\ZZ)$.
\end{ej}
%
%\section{Ends de grupos.}
%
%\begin{deff}
%	Ends de grupos
%\end{deff}
%
%\begin{obs}
%	No dependen de las presentaciones.
%\end{obs}
%
%\begin{teo}[Hopf]
%	La cantidad de ends de un grupo \fg solo puede ser...
%\end{teo}
%\begin{proof}
%\end{proof}
%
%\begin{deff}
%	Grupo accesible.
%\end{deff}
%
%\subsection{Accesibilidad en terminos de teoría de grafos.}
%
%\begin{deff}
%	Def de VK95 usando grafos.
%\end{deff}
%
%\begin{teo}
%	Probar que son equivalentes con la otra construcción.
%\end{teo}
%\begin{proof}
%	
%\end{proof}
%
%
%\begin{deff}
%	Grafos minor excluded
%\end{deff}
%
%\begin{teo}[Khukro]
%	Recaracterización de virtualmente libre usando menores de grafos.
%\end{teo}
%\begin{proof}
%\end{proof}
%
%\begin{teo}
%	Grupo qi a un árbol $\implies$ minor excluded?
%\end{teo}
%\begin{proof}
%\end{proof}









































\end{document}