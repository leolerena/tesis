% !TeX TS-program = 
\documentclass[tesis.tex]{subfiles}

%\newcommand{\ic}{independiente de contexto }
%\newcommand{\APND}{automáta de pila no determinístico }
%\newcommand{\APD}{automáta de pila determinístico }
%\newcommand{\gramatica}{{\cal G} = (V, \Sigma, P, S)}
%\newcommand{\deriva}{\overset{*}{\Rightarrow_{\cal G}}}
%\newcommand{\lengderivado}{L({\cal G})}
%\newcommand{\fg}{grupo finitamente generado }

\begin{document}
\chapter{Grupos independientes de contexto.}
Este capítulo sigue las ideas de los trabajos \cite{muller1983groups} y \cite{muller1985theory} completando muchos detalles que son omitidos por estos.

En la sección \ref{secc_grp_ic} probamos varias propiedades importantes de los lenguajes independientes de contexto que nos sirven para poder conectar la teoría de lenguajes con la teoría de grupos.

En la sección \ref{secc_wp} damos la definición formal del problema de la palabra de un grupo visto como un lenguaje y también damos una condición necesaria para que esta definición no dependa de los generadores elegidos para el grupo.


En la sección \ref{secc_teo_MS} probamos algunos resultados que nos garanticen tener una buena presentación para un grupo virtualmente libre y probamos el resultado central de este capítulo que es el teorema de Muller--Schupp \ref{teo_Muller_Schupp}.


\section{Propiedades de los lenguajes independiente de contexto.}\label{secc_grp_ic}

La familia de lenguajes independientes de contexto va a ser la siguiente:
\[
	\text{IC} = \{  L \mid \exists \Sigma, \ L \subseteq \Sigma^*, \ \ L \  \text{es independiente de contexto} \}.
\]
de manera similar podemos definir la familia de lenguajes regulares como
\[
	\text{REG} = \{  L \mid \exists \Sigma, \ L \subseteq \Sigma^*, \ \ L \  \text{es regular}  \}.
\]

La primera propiedad que vamos a ver de los lenguajes independiente de contexto es que son cerrados con respecto a la intersección con lenguajes regulares.

\begin{prop}\label{intersecciones-reg-ic}
	Sea $L \in \text{IC}$ y sea $R \in \text{REG}$ tales que existe $\Sigma$ de manera que $L,R \subseteq \Sigma^{*}$ entonces $L \cap R \in \text{IC}$.	
\end{prop}

\begin{proof}
	Sea $L$ un lenguaje \ic tal que $L \subset \Sigma^*$ y sea $R$ un lenguaje regular tal que $R \subset \Sigma^*$. 
	Queremos ver que el lenguaje $L \cap R$ es aceptado por un \APND.
	
	Si $L$ es aceptado por un \APND ${\cal M } = (Q, \Sigma, Z, \delta, q_0, F, \$)$ y R es aceptado por un autómata no determinístico ${\cal M' } = (Q', \Sigma, \delta', q_0', F')$.
	
	Consideremos el siguiente \APND
	\[
		{\cal N } = (Q \times Q', \Sigma, Z, \delta \times \delta', (q_0,q_0'), F \times F', \$),
	\]	
	tal que la función de transición está definida de la siguiente manera.
	Para todo $q_{i} \in Q, q_{j}' \in Q', a \in \Sigma, Z \in \Gamma$ vale que
	si $(q,\gamma) \in \delta(q_{i},a,Z)$ para $\gamma \in \Gamma^*$ y $q'  \in \delta(q_{j}', a)$ entonces $ ((q,q'), \gamma) \in \delta \times \delta'((q_{i},q_{j}'),a,Z)$.
	
	
	Queremos ver que $L({\cal N}) = L \cap R $.	
	Probemos primero la siguiente afirmación.
	\[
	((q_0,q_0'), w, \$) \vdash^*_{\cal N}  ((q_i,q_j), \epsilon, z) \ \iff (q_0, w, \$) \vdash^*_{\cal M}  (q_i, \epsilon, z) \ \text{y} \ (q_0', w) \vdash^*_{\cal M'} (q_j, \epsilon)  	
	\]
	Para ver esto veremos las dos implicaciones a la vez haciendo inducción en la longitud de la palabra $w$.
	
	En el caso base $|w| = 1$ de manera que $w = a \in \Sigma$.
	Este caso tenemos la igualdad porque justamente la función de transición del \APND $\cal N$ es $\delta \times \delta'$.
	
	Para el paso inductivo consideremos que $|w|=n$ de manera que $w=ua$ con $|u|=n-1$ y $a \in \Sigma$.
	Luego tenemos que $((q_0,q_0'), u, \$) \vdash^*_{\cal N}  ((q_k,q_l), \epsilon, z') \ \iff (q_0, u, \$) \vdash^*_{\cal M}  (q_k, \epsilon, z') \ \text{y} \ (q_0', u) \vdash^*_{\cal M'} (q_l, \epsilon)$.
	Nuevamente usamos nuestra definición de la función de transición $\delta \times \delta'$ para concluir que
	\[ 
	((q_i,q_j),\epsilon, z) \in \delta \times \delta'((q_k,q_l), a, z') \iff  (q_i, a, z') \in \delta(q_k, a, z') \ \text{y} \ (q_j, a) \in \delta(q_l, a).
	\]	
	Con esto terminamos de probar la afirmación.
	
	Finalmente para ver que $L({\cal N})  =  L \cap R$ usamos que por nuestra afirmación si $w \in L \cap R$ entonces es aceptado por lo dos autómatas $\cal M$ y por $\cal M'$, esto es que $(q_0, w, \$) \vdash^* (p, \epsilon, z)$ para $p \in F$ y que $(q_0', w) \vdash^* (p', \epsilon)$ para $p' \in F'$ y equivalentemente $((q_0,q_0'),w,\$) \vdash^* ((p, p'),\epsilon, z)$. 
	Dado que los estados finales del autómata $\cal N$ resultan ser $F \times F'$ obtenemos que $w \in L({\cal N}) \iff w \in L \cap R$.
	Concluimos así que el lenguaje $L \cap R$ resulta ser \ic tal como queríamos ver.		
\end{proof}

Ahora vamos a estudiar la relación de esta familia de lenguajes con los morfismos de monoides. 
Probaremos que IC es cerrada por imágenes de morfismos de monoides y por preimágenes de morfismos de monoides.
 

\begin{prop}\label{morfismos-monoides-ic}

		Sea $L \in \text{IC}$, $\Sigma$ tal que $L \subseteq \Sigma^{*}$ y $h:\Sigma^{*} \to \Delta^*$ un morfismo de monoides 
		 entonces $h(L) \in \text{IC}$.
		 
\end{prop}

\begin{proof}
		Consideramos $L$ lenguaje \ic sobre $\Sigma$.
		Esto nos dice que existe una gramática $\gramatica $ independiente de contexto, que la tomamos en forma normal de Chomsky, tal que $L(\cG) = L$. 
		Si tenemos un morfismo de monoides $h: \Sigma^* \to \Delta^*$ consideramos la sustitución $\sigma:\Sigma \cup V \to \Delta^* \cup V$ definida por $\sigma(a) = h(a)$ para toda $a \in \Sigma$ y $\sigma(A) = A$ para toda $A \in V$.		
		Para probar que $h(L)$ es \ic vamos a construir una gramática $\cG'$ tal que $L(\cG') = h(L)$.
		Sea la gramática $\cG'  = (V, \Delta, P', S')$ tal que si $A \to w \in P$ luego $A \to \sigma(w) \in P'$.
		Es decir la única diferencia con la gramática $\cG$ es que reemplazamos en cada producción $P \in \cG$ a cada letra $a \in \Sigma$ por $h(a) \in \Delta^*$.
		La gramática sigue siendo \ic porque las producciones tienen la forma $A \to u$ con $A \in V, u \in (\Delta \cup V)^*$.
		Para finalizar la demostración nos alcanza con ver que genera al lenguaje que queremos.
		
		Para esto notemos que vale la siguiente igualdad:
		\[
			S \to^* w \iff S' \to^{*} h(w).
		\]
		Veamos la ida. 
		Si tenemos que $S \to^* w $  para $w = a_{1}a_{2} \dots a_{k}$ luego esto dice que existe una sucesión finita de producciones $P_{1} = S \to AB, \dots, P_{n} = C \to a_{j}$ para $ 1 \le j \le k$ de manera que 
		$S \to AB \to \dots \to a_{1}\dots C \dots a_{k} \to a_{1} \dots a_{j} \dots a_{k} = w$.
		
		Si tomamos la sucesión de producciones para la gramática $\cG'$ dada por $P'_{1} = S' \to A'B', \dots, P'_{n} = C' \to h(a_{j})$ luego obtuvimos que $S' \to^* h(w)$.
		De manera idéntica se prueba la vuelta.
		Así vimos que $w \in L(\cG) \iff h(w) \in L(\cG')$ y probamos así que $h(L) = L(\cG')$.
		
		
%		Sea $w=a_{0}\dots a_{n} \in L$ luego como $L(\cG) = L$ vale que 
%		$S \overset{*}{\implies}_{\cG} w$. 
%		Como $\cG$ está en forma normal de Chomsky luego vale que para todo $0 \le i \le n$ existe $A_{i} \in V$ tal que $A_{i} \to a_{i}$.
%		Como las producciones de $\cG'$ son de la pinta $A \to h(a)$ si $A \to a$ era una producción de $\cG$ luego tenemos que $A_{i} \to h(a_{i})$ y así que $S' \overset{*}{\implies}_{\cG'} h(w)$.
%		
%		Probamos que $L(\cG') \subseteq h(L)$.
%		Para esto probaremos la siguiente afirmación por inducción.
%		Para todo $n \in \NN$ vale que si $A \in V$ luego si $u \in L(A)$ y $|u| = n$ entonces $u \in h(L)$.
%		
%		El caso base es claro porque si $|u| = 1$ y $u \in L(A)$ esto dice que necesariamente que $A \to u$ entonces por como definimos a la gramática $\cG'$ tenemos que $u = h(a)$ para $a \in \Sigma$.
%		
%		Para el paso inductivo sea $|u| = n$ luego tenemos que $S' \to AB \overset{*}{\implies}_{\cG'} u$ para ciertos $A, B \in V$.
%		Por como definimos a la gramática $\cG'$ tenemos que $A \overset{*}{\implies}_{\cG} u_{1}$ y $B \overset{*}{\implies}_{\cG} u_{2}$ tales que $u = u_{1}u_{2}$ y $|u_{1}|, |u_{2}| \ge 0$.
%		Por la hipótesis inductiva tenemos que $u_{1} \in h(L)$ y que $u_{2} \in h(L)$ por lo que $u \in h(L)$ tal como queríamos ver.
		
\end{proof}


\begin{prop}
	Sea $L \in \text{IC}$, $\Sigma$ tal que $L \subseteq \Sigma^{*}$ y $h:\Delta^{*} \to \Sigma^*$ un morfismo de monoides 
	entonces $h^{-1}(L) \in \text{IC}$.
\end{prop}

\begin{proof}
	Sea $L$ un lenguaje \ic sobre el alfabeto $\Sigma$ tal que es aceptado por un \APND ${\cal M } = (Q, \Sigma, Z, \delta, q_0, F, \$)$.
	Queremos ver que el lenguaje $h^{-1}(L) \subset \Delta^*$ es independiente de contexto.
	 
	 Consideremos el conjunto finito ${\cal U } = \{ h(a) \mid a \in \Delta \}$ luego $\text{Pos}(\cal U)$ los posfijos de estas finitas palabras.
%	Consideremos el número $ n = \max_{a \in \Delta} |h(a)|$ y el conjunto $\Sigma^{\le n} = \{ w \in \Sigma^* : |w| \le n  \}$.	
	Definimos un \APND de la siguiente forma
	\[
	{\cal M' } = (Q \times \text{Pos}({\cal U}), \Delta, Z, \delta, (q_0, \epsilon), F \times \{ \epsilon \}, \$)
	\]
	Finalmente nuestra función de transición resulta ser para $a \in \Delta, z \in Z, q \in Q$
	\begin{equation}\label{eq_prop_morf_1}
		\delta((q,\epsilon),a,z) = ((q,h(a)),z)
	\end{equation} 
	y en el caso que $u \in \text{Pos}(\cal U)$ y $u \neq \epsilon$ vale que si $u = yu'$ con $y \in \Sigma, u' \in \text{Pos}(\cal U)$ luego
	\begin{equation}\label{eq_prop_morf_2}
		\delta((q,yu'),\epsilon,z) = ((p,u'),z')
	\end{equation}
	si $\delta(q,y,z) = (p,z')$.
	
	Probemos primero la siguiente afirmación.
	Para cada $w \in \Delta^*$ tenemos la siguiente equivalencia,
	\[
	((q_0, \epsilon),w,z) \vdash^*_{\cal M'} ((q,\epsilon), \sigma) \iff (q_0,h(w), z) \vdash^*_{\cal M} (q, \sigma).
	\]
	
	Para probar esta equivalencia lo hacemos por inducción en la longitud de $|w|$.
	Para el caso base tenemos que $w = a \in \Delta$.
	En este caso tenemos que $((q_0, \epsilon), a, z) \vdash ((q,h(a)), z)$ usando una vez el caso \ref{eq_prop_morf_1} de la función de transición $\delta'$.
	Una vez en este estado por como definimos la función de transición tenemos que $ (q_0,h(a), z) \overset{*}{\vdash }(q, \sigma)  \iff ((q_0,h(a)), \epsilon ,z) \overset{*}{\vdash} ((q,\epsilon), \sigma)$ usando reiteradas veces el caso \ref{eq_prop_morf_2} de la función de transición $\delta'$.
	El caso general tenemos una palabra $w$ tal que $|w|=n$.
	Sabemos que la afirmación vale para cualquier palabra de longitud menor a $n$.
	En particular si $w=ua$ con $|u|=n-1$ y $a \in \Delta$, tenemos que por la hipótesis inductiva que 
	\[
	(q_0',u,z) \vdash^*_{\cal M'} ((q,\epsilon), \sigma) \iff (q_0,h(u), z) \vdash^*_{\cal M} (q, \sigma)
	\]
	entonces de nuevo por el mismo razonamiento que hicimos para el caso base tenemos probada la afirmación.
	
	Para concluir la demostración notamos que por nuestra afirmación si $w \in L(\cal M')$ entonces existe $q \in F$ tal que $ ((q_0, \epsilon),w,z) \vdash^*_{\cal M'} (q,\epsilon) $ y esto sucede sí y solo sí $(q_0,h(w), z) \vdash^*_{\cal M} (q, \sigma)$, dicho de otra forma que $h(w) \in L(\cal M)$.	
	Entonces $w \in L(\cal M')$ si y solo si $h(w) \in L$.
	Esto nos dice que el lenguaje aceptado por estado final de $\cal M'$ resulta ser $L' = \{ w \in \Delta^* : h(w) \in L \} = h^{-1}(L)$.
\end{proof}

La herramienta principal que tenemos para ver que cierto lenguaje $L$ no es \ic es usar el siguiente lema.

\begin{lema}[Pumping] \label{pumping}
	Sea $L$ un lenguaje independiente de contexto entonces existe una constante $n \ge 0$ tal que para todas las palabras $\gamma \in L$ de longitud al menos $n$ existe una factorización $\gamma = uvwxy$ con $|vwx| \le n$ y $|vx| > 0$ tal que para todo $i \in \NN$ vale que $uv^iwx^iy \in L$.
\end{lema}

\begin{proof}
	Ver \cite[p.281]{hopcraft-ullman}.
\end{proof}



\section{El problema de la palabra.}\label{secc_wp}


Sea $G$ un grupo finitamente generado por $A$ entonces si tomamos $B = A \cup A^{-1}$ el conjunto simétrico de generadores resulta que $G$ es finitamente generado como monoide por $B$, en otras palabras, existe un epimorfismo de monoides $\pi:B^* \to G$.
El problema de la palabra consiste en dadas $w,w' \in B^*$ determinar si $\pi(w) {=} \pi(w')$.
Equivalentemente esto es ver si $\pi(w'w^{-1}) = 1$.
Definimos entonces el siguiente lenguaje.

\begin{deff}
	Dado $G$ un grupo finitamente generado 
	y $\Sigma$ conjunto finito con un epimorfismo de monoides $\pi:\Sigma^* \to G$ entonces
	el \emph{problema de la palabra de $G$ para los generadores $\Sigma$} es el siguiente lenguaje	
	\[ 
	\text{WP} (G, \Sigma) = \{ w \in \Sigma^* \ | \ \pi(w)= 1 \}.
	\]
\end{deff}

\begin{obs}
	En esta definición que damos del problema de la palabra no estamos considerando conjuntos simétricos de generadores sino que estamos considerando conjuntos de generadores como monoides arbitrarios.
	Esto es que $\Sigma$ no necesariamente cumple que $\Sigma = A \cup A^{-1}$ para $A$ conjunto finito de generadores de $G$ como grupo.
\end{obs}


Dado que este lenguaje depende del conjunto de generadores elegido nos interesa saber qué condiciones tienen que cumplir los lenguajes o bien qué condiciones tienen que cumplir los grupos para que no exista esta dependencia en los generadores.
En este contexto nos interesan las familias de lenguajes que cumplen las siguientes propiedades.
\medskip
\begin{deff}
	Una familia de lenguajes $\CC$ es un \emph{cono} si para todo $L \in \CC$ tal que $L \subseteq \Sigma^*$ resulta que:
	\begin{itemize}
		\item[\textbf{C1.}] Es cerrado por imágenes de morfismos de monoides. 
		Para todo $\phi:\Sigma^* \to \Delta^*$ morfismo de monoides debe ser que $\phi(L) \in \CC$.
		\item[\textbf{C2.}] Es cerrado por preimagenes de morfismos de monoides. 
		Para todo $\phi:\Delta^* \to \Sigma^*$ morfismo de monoides  debe ser que $\phi^{-1}(L) \in \CC$. 
		\item[\textbf{C3.}] Es cerrado por intersecciones con lenguajes regulares. 
		Para todo $R \subseteq \Sigma^*$ lenguaje regular vale que $L \cap R \in \CC$.
	\end{itemize}
\end{deff} 


Los conos de lenguajes cumplen la siguiente propiedad de gran importancia para el estudio del problema de la palabra.
\medskip
\begin{prop}\label{prop-cono-wp}
	Sea $\CC$ cono de lenguajes y $G$ un grupo finitamente generado por $\Sigma$.
	Sea $WP(G, \Sigma)$ el lenguaje del problema de la palabra. 
	Si $WP(G, \Sigma) \in \CC$ luego valen las siguientes afirmaciones:
	\begin{itemize}
		\item[\textbf{W1.}] $WP(G, \Delta) \in \CC$ para cualquier conjunto de generadores $\Delta$.
		\item[\textbf{W2.}] $WP(H) \in \CC$ para todo subgrupo $H$ \fg de $G$.
	\end{itemize} 
\end{prop}
\begin{proof}
	Vamos a probar \textbf{W1}.
	Como $\Delta$ y $\Sigma$ son dos conjuntos finitos de generadores de $G$ entonces tenemos dos epimorfismos de monoides:
	$\delta: \Delta^* \to G$ y $\pi:\Sigma^* \to G$.
	Si $\Delta = \{ b_{1}, \dots, b_{n} \}$ entonces definimos $\Delta' = \{ b'_{1}, \dots, b'_{n}   \} \subseteq \Sigma^*$ de manera que $b'_{i} \in \pi^{-1}(\delta(b_{i}))$ para todo $1 \le i \le n$.
	Tenemos una función biyectiva $f:\Delta \to \Delta'$ definida como $f(b_{i}) = b'_{i}$ para todo $1 \le i \le n$.
	Por la propiedad universal de los monoides libres tenemos que existe $\ol f: \Delta^* \to \Sigma^*$ morfismo tal que hace conmutar al siguiente diagrama
	\begin{center}
		\begin{tikzcd}
			\Delta^* \arrow[r, "\ol{f}",dashed ]  & \Sigma^* \\
			\Delta \arrow[ru, "f",  swap]  \arrow[u,"\iota",swap]  &  
		\end{tikzcd}
	\end{center}
	
	Por la construcción que hicimos del morfismo $\ol f$ tenemos que el siguiente diagrama también conmuta:
	\begin{center}
		\begin{tikzcd}
			\Delta^* \arrow[r, "\delta"] \arrow[d,"\ol{f}",swap] & G \\
			\Sigma^* \arrow[ru, "\pi",swap]    &  
		\end{tikzcd}
	\end{center}
	para probar que $\pi \circ \ol f = \delta$ nos alcanza con probarlo sobre $\Delta$.
	Para esto notemos que si $b_{i} \in \Delta$ luego $\pi(\ol f(b_{i})) = \pi(f(b_{i})) = \pi(b_{i}')$ donde $b_{i}' \in \pi^{-1}(\delta(b_{i}))$ lo que implica que $\pi(b'_{i}) = \delta(b_{i})$ tal como queríamos ver.
	
	
	Notemos que como el diagrama conmuta luego vale que 
	\[
	\ol{f}^{-1}(\pi^{-1}(1)) = \delta^{-1}(1)
	\]
	lo que implica que por la definición del lenguaje del problema de la palabra que
	\[
	\ol{f}^{-1}(WP(G,\Sigma)) = WP(G, \Delta).
	\]
	Como $WP(G, \Sigma) \in \CC$ resulta que por la propiedad \textbf{C2} de los conos de lenguajes que $\ol{f}^{-1}(WP(G,\Sigma)) \in \CC$ por lo tanto $WP(G, \Delta) \in \CC$ tal como queríamos ver.
	
	Veamos ahora que vale \textbf{W2}. 
	Sea $\Sigma$ conjunto de generadores de $H$.
	Podemos extender este conjunto a otro conjunto finito $\Sigma'$ tal que $\Sigma'$ genera a $G$ y $\Sigma \subseteq \Sigma'$. 
	De esta manera la siguiente igualdad es inmediata
	\[
	WP(H, \Sigma) = WP(G, \Sigma') \cap \Sigma^*
	\]
	y dado que $WP(G, \Sigma') \in \CC$ entonces por la propiedad \textbf{C3} de los conos vale que $WP(H, \Sigma) \in \CC$.
	
\end{proof}

La moraleja de este resultado es que si $\CC$ es un cono entonces si $G$ es un grupo finitamente generado tal que para cierto conjunto de generadores finito $\Sigma$ vale que $WP(G, \Sigma) \in \CC$ luego decimos que $G$ es un grupo $\CC$.
Notamos $WP(G)$ al lenguaje del problema de la palabra en este caso. 

 



La flia de lenguajes $\text{IC}$ es un cono.
Esto se puede ver a partir de las proposiciones  \ref{intersecciones-reg-ic} y \ref{morfismos-monoides-ic}.

\begin{deff}
	Si $G$ es un \fg generado por un conjunto finito $\Sigma$ y el lenguaje $WP(G, \Sigma)$ es independiente de contexto entonces diremos que $G$ es un \emph{grupo independiente de contexto}.
\end{deff}

Construyamos algunos ejemplos de grupos independientes de contexto.
\begin{prop}
	Todo grupo libre $F$ finitamente generado es independiente de contexto.
\end{prop}
\begin{proof}
			Sea $F$ grupo libre generado por un conjunto finito $A$ tal que $1 \notin A$. 
	Sea  $B = A \cup A^{-1}$ el conjunto de generadores simétrico de $A$ y sea $\pi:B^* \to G$. 
	Dada $w \in B^*$ notaremos $\pi(w)$ a la palabra reducida que representa el mismo elemento que $w$ en el grupo $G$.
	
	Probemos que ${WP}(F,B)$ es un lenguaje independiente de contexto construyendo un autómata de pila $\cal M$ tal que acepte a este lenguaje.
	Consideremos el siguiente autómata de pila:
	\[
	{\cal M} = (\{ q_{0} \}, B, B \cup \{ 1 \}, \delta, q_{0}, \{q_{0}\}, 1,). 
	\]
	
	Por como lo definimos tiene un solo estado que es final e inicial.
	El alfabeto de entrada es el conjunto de generadores $B$ mientras que el de pila es $B \cup \{ 1 , \$ \}$ donde $1$ es el símbolo inicial de la pila.
	Representamos al autómata de la siguiente manera: sean $b_{i}, b_{j} \in B$ luego notamos $b_{i} \cdot b_{j}$ la concatenación en el monoide libre $B^*$ de ambos elementos. 
	El autómata lo describimos de la siguiente manera: 
	
	\begin{center}
		\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=6.5cm,
			scale = 1,transform shape]
			
			\node[state,initial,accepting] (q_0) {$q_0$};
			
			\path 
			(q_0) edge    [loop above]          node {$b_{i}, b_{j} \mid  b_{i} \cdot b_{j}$ \ }  (q_0)
			(q_0) edge    [loop below]          node {$b_{i}, b_{i}^{-1} \mid  \epsilon$ \ }  (q_0);
			
		\end{tikzpicture}
	\end{center}
	
	Notemos que este autómata es determinístico.				
	Consideramos el lenguaje aceptado por estado final y por $1$ en la pila
	\[
	L({\cal M}) = \{  w \in B^* \mid (q_{0},w,1)   \vdash^*  (q_{0}, \epsilon, 1)  \}.
	\]
	
	Probamos la siguiente observación.
	Sea $w = uv \in B^*$ luego si
	$(q_{0},uv,1) \overset{*}{\vdash} (q,v,u')$ entonces $u' = \pi(u)$.
	
	Para probar esto lo hacemos por inducción en la longitud de $u$.
	Supongamos que $|w| \ge 1$ caso contrario no hay nada que probar.
	Sea entonces $w = bv$ con $v \in B^*$ y $b \in B$, en este caso $u = b$.
	Para el caso base tenemos que $(q_{0},bv,1) \vdash (q_{0},v,b)$ donde usamos que $\pi(b) = b$ dado que $1 \notin B$.
	Para el paso inductivo se sigue de manera idéntica.
	Supongamos que vale que: \newline			
	$(q_{0},uv,1) \overset{*}{\vdash} (q_{0}, v, \pi(u))$.
	Sea $v=bv'$ luego $(q,v,\pi(u)) \overset{*}{\vdash} (p,v',b \cdot \pi(u)^R)$.
	Donde $b \cdot \pi(u)^R$ es una palabra reducida y en este caso vale que $b \cdot \pi(u)^R = (\pi(u \cdot b))^R$ tal como queríamos ver.
	
	
	A partir de esta observación obtenemos que si $w \in L(\cal M)$ luego 
	$(q_{0},w,1) \overset{*}{\vdash} (q_{0},\epsilon,1)$ lo que nos dice que $\pi(w) = 1$ y esto nos dice que $w \in WP(F, B)$.
	Para la otra contención usamos que es un \APD por lo tanto cada palabra se puede consumir de una única forma.
	Por la observación tenemos que $(q_{0},w,1) \overset{*}{\vdash} (q_{0},\epsilon,1)$ dado que $\pi(w) = 1$.
\end{proof}

En particular obtuvimos que los grupos libres tienen un problema de la palabra independiente de contexto determinístico especial.
Más en adelante construiremos un \APD que acepta al problema de la palabra de un grupo virtualmente libre generalizando esta misma construcción.
Veamos ahora un grupo que no es independiente de contexto.

\begin{prop}
	El grupo $\ZZ \times \ZZ$ no es independiente de contexto.
\end{prop}

\begin{proof}
	Tomamos los siguientes generadores como monoide $\Sigma = \{ a,b,c \}$ con morfismo de monoides $\pi: \Sigma^* \to \ZZ \times \ZZ$ dado por $\pi(a)=(1,0), \pi(b)=(0,1), \pi(c)=(-1,-1)$.
	Bajo esta presentación 
	\[
	WP(\ZZ \times \ZZ, \Sigma) = \{ \gamma \in \Sigma^*  : \ \exists n \in \NN, \ |\gamma|_a = |\gamma|_b = |\gamma|_c = n \}.
	\]
	Este lenguaje no es independiente de contexto.
	Para eso usemos el lema del pumping \ref{pumping} para probarlo por contradicción.
	Si fuera \ic debería existir una constante $n \ge 0$ tal que hace valer las hipótesis del lema.
	Consideremos la palabra $\gamma = a^n b^n c^n \in WP(G, \Sigma)$.
	Si tenemos una factorización 
	\[
	uvwxy = a^nb^nc^n
	\]
	tal que $|vwx| \le n$, esto implica que no todas las letras aparecen en $vwx$.
	Supongamos que la letra que no aparece es $c$.
	Por otro lado como $|vx| > 0$ esto nos dice que al menos una letra aparece en la subpalabra $vx$.
	Si tomamos $i=0$ esto implicaría que $uwy \in WP(G,\Sigma)$ pero esto es una contradicción porque $|uwy|_{c} > |uwy|_{a}$ y $|uwy|_{c} > |uwy|_{b}$.
\end{proof}
 





\section{Teorema de Muller--Schupp.}\label{secc_teo_MS}

Nuestro objetivo es probar que todo grupo \vl resulta ser \ic pero para esto debemos primero probar algunos resultados sobre grupos virtualmente libres.

Primero vamos a ver que todo grupo virtualmente libre puede tomarse de manera que el subgrupo libre sea normal.
Para eso nuestra estrategia es probar que la intersección de los conjugados del subgrupo libre tiene índice finito y también es un grupo libre. 
La parte más laboriosa de esta demostración es la de probar que todo subgrupo de un grupo libre es libre.
Este resultado sale como un corolario directo del teorema central de Bass--Serre que probamos en el capítulo \ref{cap_BS}.
\begin{deff}
	Sea $G$ un grupo y $H$ un subgrupo entonces el \emph{normalizador} de $H$ en $G$ es el siguiente subgrupo
	\begin{equation*}
		N_G(H) = \{ g\in G : gHg^{-1} = H  \}
	\end{equation*}
\end{deff}

Denotaremos por $S= \{ g \in G :  gHg^{-1} \}$ al conjunto de conjugados del subgrupo $H$. 

El siguiente lema nos va decir que los grupos de índice finito tienen finitos conjugados.

\begin{lema}\label{lema_normalizador_conjugados}
	Si $G$ es un grupo finitamente generado y $H$ es un subgrupo de índice finito entonces $N_G(H)$ tiene índice finito y más aún $[G:N_G(H)] = |S|$.
\end{lema}
\begin{proof}
	Para ver que tiene índice finito notamos que $H \le N_G(H)$ por lo tanto tenemos que 
	\[
	[G:N_G(H)] \le [G:H] < \infty.
	\]
	
	Para probar la otra afirmación definimos la siguiente función:
	\begin{align*}
		S  &\to  G/N_G(H)  \\
		sHs^{-1} &\mapsto sN_G(H).
	\end{align*}
	Veamos que es biyectiva viendo que es inyectiva ya que $G/N_{G}(H)$ es un conjunto finito.
	
	Si $sN_G(H) = tN_G(H)$ entonces tenemos que esto sucede si y solo sí $t^{-1}s \in N_G(H)$.
	Esto nos dice que por la definición del normalizador,
	\[
	t^{-1}s H s^{-1}t = H \iff sHs^{-1} = tHt^{-1}
	\]
	y de esta manera obtenemos que la función está bien definida y es inyectiva y por lo tanto biyectiva.
	
\end{proof}

Este lema nos permite intersecar finitos grupos de índice finito para conseguirnos otro subgrupo de índice finito. 


\begin{lema}\label{lema_indice_interseccion}
	Sea $G$ grupo y $K_1, \dots, K_n$ subgrupos tales que $K_{i}$ tiene índice finito para todo $ 1 \le i \le n $ entonces $\bigcap_{i=1}^{n} K_{i}$ es un subgrupo de índice finito.
\end{lema}
\begin{proof}
	Lo probaremos por inducción en la cantidad de subgrupos de índice finito que estamos intersecando.
	En el caso base tenemos dos subgrupos $H,K$ de índice finito.
	Primero notamos que por el segundo teorema de isomorfismo para grupos tenemos que existe una biyección entre los siguientes conjuntos de cosets $ KH / H \simeq K / K \cap H $ (en principio ningún subgrupo es normal así que no podemos hablar de grupos sino de conjuntos).
	Como  $|KH / H| \le |G / H| < \infty$ dado que $H$ tiene índice finito obtenemos así que $|K / K \cap H| < \infty$.
	Entonces:
	\[
	[G:K\cap H] = [G:K][K: K \cap H]
	\]
	y como ambos índices de la derecha son finitos por lo visto obtenemos que $K \cap H$ es un subgrupo de índice finito también tal como queríamos ver.
	
	Para la demostración del paso inductivo debemos ver que si tenemos $n$ subgrupos de índice finito $K_{1}, \dots, K_{n}$ entonces $\bigcap_{i=1}^{n} K_{i}$ también tiene índice finito.
	La demostración se reduce a la del caso base si tomamos $H = \bigcap_{i=1}^{n-1} K_{i}$ (que por hipótesis inductiva tiene índice finito) y $K = K_{n}$.
\end{proof}

Este lema nos garantiza que tomar subgrupos de índice finito preserva la propiedad de ser finitamente generado.

\begin{lema}\label{lema_subg_fg}
	Sea $G$ un \fg y sea $H$ subgrupo de índice finito entonces $H$ es un \fg.
\end{lema}
\begin{proof}
	Sea $A = \{g_1, \dots, g_n\}$ conjunto finito de generadores de $G$.
	Sea $T =\{t_1, \dots, t_m\}$ conjunto transversal a derecha de $H$ tal que $t_1=1$.
	
	Dado $g_j$ generador de $G$ debe existir $h_{ij} \in H$ tal que $h_{ij}t_{k} = t_ig_j$ para cierto $t_k$.
	También debe existir $h_i \in H$ de manera que $ h_i t_{k} = g_i$ para cierto $t_k$.
	Veamos que el conjunto finito 
	\[
	B = \{ \ h_{ ij}  \mid {1 \le i,j \le n } \} \cup \{ \ h_i \mid {1 \le i \le n} \}
	\]
	genera a $H$.
	
	Dado $h \in H$ veamos que se puede escribir como una palabra en $B$. 
	Tenemos que 
	\[
	h = g_{i_1}\dots g_{i_r}
	\]
	donde usamos el conjunto finito de generadores de $G$.
	
	Por lo visto anteriormente podemos escribir  $g_{i_1} = h_{i_1}t_{k_1}$ para cierto y entonces nos queda la siguiente escritura de $h$,
	\[
	h = h_{i_1}t_{k_1} g_{i_2}\dots g_{i_r}
	\]
	entonces usando que $h_{k_{1}i_{2}}t_{k_2} = t_{k_1}g_{i_2} $ llegamos a la siguiente escritura de $h$,
	\[
	h = h_{i_1}h_{k_{1}i_{2}}t_{k_2}\dots g_{i_r}.
	\]
	Repitiendo inductivamente este procedimiento llegamos a que $h =h_{i_1}h_{k_{1}i_{2}} \dots t_{k_r}$.
	Necesariamente $t_{k_r} = 1$ porque $T$ es un conjunto de transversales de $H$ y $h \in H$.
	Concluimos que $B$ es un conjunto finito de generadores de $H$.
	
\end{proof}


El siguiente lema omitimos la demostración que resulta ser estándar en la literatura.
La intersección de los conjugados de un subgrupo resultan ser un subgrupo normal.

\begin{lema}\label{lema_int_normal}
	Sea $G$ grupo, sea $H$ subgrupo de $G$ luego el subgrupo $K = \bigcap_{g \in G} gHg^{-1}$ es un subgrupo normal de $G$.
\end{lema}

\begin{proof}
	Es un subgrupo porque dados $k_{1}, k_{2} \in K$ tenemos que para todo $g \in G$ vale que $k_{1} = gh_{1}g^{-1}$ y $k_{2} = gh_{2}g^{-1}$ para ciertos $h_{1},h_{2} \in H$.
	De esta manera $k_{1}k_{2} = g h_{1}h_{2}g^{-1} \in gHg^{-1}$. 
	Como esto lo hicimos para un $g \in G$ genérico concluimos que $k_{1}k_{2} \in K$ tal como queríamos ver.
	
	Para ver que es normal consideramos la acción de $G$ sobre los cosets de $K$ en $G$ por multiplicación a izquierda.
	Sea $\phi:G \to G/K$ esta acción luego $\ker(\phi) = \{  k \in G \mid kgH = gH, \ \forall g \in G \}$. 
	Esto nos dice que $k \in \ker(\phi) \iff \forall g \in G, \exists h_{g} \in H. \ kg = gh_{g}$ y esto implica que $k = gh_{g}g^{-1}$ para todo $g \in G$.
	De esta manera probamos que $K = \ker(\phi)$ y por lo tanto vimos que $K$ es normal.
\end{proof}

Finalmente podemos probar que la clase de grupos virtualmente libres resulta ser cerrada por subgrupos de índice finito y que a su vez los subgrupos libres pueden ser tomados para que sean normales.

\begin{prop}\label{prop_vls}
	Para todo grupo $G$ \vl \ valen las siguientes propiedades.
	\begin{enumerate}
		\item Si $F$ es un subgrupo libre de índice finito de $G$ entonces podemos tomarnos otro subgrupo $F'$ de manera que sea normal, libre y de índice finito.
		\item Si $H$ es un subgrupo de $G$ de índice finito entonces $H$ también resulta ser \vl.
	\end{enumerate}
\end{prop}

\begin{proof}
	Vamos a probar \textbf{1}.
	Si $G$ es virtualmente libre y $F$ es un subgrupo libre tenemos que la cantidad de conjugados de $F$ es finita por el lema \ref{lema_normalizador_conjugados}.
	Por el lema \ref{lema_int_normal} tenemos que el siguiente subgrupo de $G$ es normal
	\[
	F' = \bigcap_{g \in G} gFg^{-1}.
	\]
	Veamos que este subgrupo $F'$ nos sirve. 
	
	
	Como $F$ tiene índice finito y todos sus conjugados al ser isomorfos a $F$ también tienen índice finito entonces $F'$ tiene índice finito por el lema \ref{lema_indice_interseccion}.
	Como $G$ es finitamente generado por ser virtualmente libre entonces usando \ref{lema_subg_fg} obtenemos que $F'$ es finitamente generado.
	Finalmente notamos que es libre por el resultado \ref{coro_niels_sch} que nos dice que todo subgrupo de un grupo libre es libre, en particular al ser $F'$ subgrupo de $F$ que es libre obtenemos que $F'$ es libre tal como queríamos ver.
	
	Probemos \textbf{2}. 
	Por el lema \ref{lema_subg_fg} obtenemos directamente que $H$ es un grupo finitamente generado.
	Si $F$ es un libre de índice finito en $G$ podemos tomar $H \cap F$ que es libre por ser subgrupo de un libre de acuerdo al resultado \ref{coro_niels_sch}.
	El índice resulta ser finito puesto que 
	\[
	[H:F\cap H] \le [G:F] < \infty.
	\]
\end{proof}


\begin{obs}\label{obs_presentacion_vl}
	Dado $G$ \vl vamos a construirnos una presentación en particular.
	Como es un grupo \vl tenemos $F$ subgrupo libre que podemos tomarlo normal por \ref{prop_vls} y $G/F$ grupo finito de manera que podemos escribir a $G$ como una extensión de estos dos grupos por medio de la siguiente forma
	\begin{center}
		\begin{tikzcd}
			1 \arrow[r] & F \arrow[r, "\iota"] & G \arrow[r, "\pi"] & G/F \arrow[r] & 1
		\end{tikzcd}
	\end{center}
	donde $\iota: F \to G$ es la inclusión como subgrupo y $\pi: G \to G/F$ es la proyección.

	
	Consideremos que $F$ es libre generado por $A = \{ a_i : 1 \le i \le n \}$ bajo la suposición que $1 \notin A$.
	Por otro lado el cociente $G/F$ resulta ser finito entonces $G/F = \{ q_i : 1 \le i \le m \}$.
	Elegimos un transversal a derecha $T = \{ t_1, \dots, t_m \}$ de manera que $\pi(t_i)= q_i$ y fijamos para que $t_1 = 1$.
	
	Dado que es un transversal tenemos que se deben cumplir las siguientes dos relaciones para todo $a_l \in A$ y $t_i,t_j,t_k \in T$. 
	\begin{enumerate}
		\item $t_ia_{l}t_i^{-1} = u_{il}$ donde $u_{il} \in F$ usando que $F$ es normal.
		\item Si tenemos que $q_iq_j = q_k$ entonces tenemos la siguiente igualdad 
		$(Ft_{i}) (Ft_{j}) = Ft_{k}$
		de donde se desprende que debe existir $z_{ij} \in F$ tal que 
		 $t_it_j = z_{ij}t_k$.
	\end{enumerate}
	Sean
	\[
		W = A \cup A^{-1} \cup T, \quad R = \{t_ia_{l}t_i^{-1} = u_{il},  t_it_j = z_{ij}t_k \quad \forall (i,j,k,l) :   1 \le i,j,k \le m, 1 \le l  \le n \}
	\]
	Vamos a probar que $G \equiv \langle W \mid R \rangle$. 
	Denotamos a este grupo presentado como $H = \langle W \mid R \rangle$ y sea $F_{W}$ el grupo libre sobre sus generadores.
	
	Notemos que $W$ genera a $G$ porque
	dado $g \in G$ luego existe $a \in F$ y $t \in T$ de manera que $g = at$.
	Como $F$ es libre generado por $A \subseteq W$ y $T \subseteq W$ entonces $g$ está generado por $W$. 
	Esto nos dice que tenemos un epimorfismo de grupos $\varphi: F_{W} \to G$.
	
	Por como elegimos las relaciones $r \in R$ de $H$ tenemos que el grupo $G$ las cumple.
	De esta manera por la propiedad universal del cociente tenemos un epimorfismo de grupos $\ol \varphi$ tal que hace conmutar al siguiente diagrama	
	\begin{center}
		\begin{tikzcd}
			F_{W} \arrow[dd] \arrow[rr, "\varphi"]          &  & G \\
			&  &   \\
			H \arrow[rruu, "\overline \varphi"', dashed] &  &  
		\end{tikzcd}
	\end{center}
	
	Vimos que $\ol \varphi$ es un epimorfismo, veamos ahora que es un monomorfismo.
	Sea $w \in H$ luego queremos ver que $\ol \varphi(w) = 1 \iff w = 1$.
	Por el mismo procedimiento que hicimos en la demostración del lema \ref{lema_subg_fg} 
	tenemos que podemos llevar a $w$ (vista como una palabra en $F_{W}$) a que sea de la siguiente pinta
	\[
		w = st
	\]
	donde $s \in F$ reducida y $t \in T$.
	
	Dada $w \in W^*$ supongamos que $|w| \ge 2$ caso contrario no tenemos nada para hacer.
	Sea entonces $w = w_{1}w_{2}w'$ con $w_{1}, w_{2} \in W$ y $w' \in W^*$.
	Separamos en casos.
	\begin{itemize}
		\item Si $w_{1}, w_{2} \in A \cup A^{-1}$ no hacemos nada.
		\item Si $w_{1}, w_{2} \in T$ luego si $w_{1} = t_{i}$ y $w_{2} = t_{j}$ cambiamos a $t_{i}t_{j}$ por $z_{ijk}t_{k}$.
		\item Si $w_{1}\in T$ y $ w_{2} \in A \cup A^{-1}$ luego si $w_{1} = t_{i}$ y $w_{2} = a_{l}$ cambiamos a $t_{i}a_{l}$ por $u_{il}t_{i}$.
		\item Si $ w_{1} \in A \cup A^{-1}$ y $w_{2} \in T$ no hacemos nada.
	\end{itemize}
	Hacemos este procedimiento inductivamente empezando desde la izquierda y como la longitud $|w|$ es finita eventualmente llevamos a una palabra de la pinta $w = s't$ con $t \in T$ y $s' \in A \cup A^{-1}$.
	Para terminar reducimos la palabra $s' \in A \cup A^{-1}$ a una palabra reducida tal como hicimos en el lema \ref{lema_subg_fg}.
	
	
	
	
	Por lo tanto $\ol \varphi (w) = \ol \varphi(st) = st$.
	Entonces $st = 1$ si y solamente si $s=1$ y $t=1$. 
	Esto nos dice que $\ol \varphi(w) = 1$ si y solamente si $w=1$. 
	Concluimos así que $\ol \varphi$ es un isomorfismo de grupos tal como queríamos ver y por lo tanto  $\langle W \mid R \rangle$ resultó ser una presentación de $G$.
\end{obs}
	\medskip
	Sea $G$ grupo \vl  \ y consideremos una presentación $\langle W  \mid  R \rangle$ como la que construimos en \ref{obs_presentacion_vl} respetando la misma notación que introducimos en esta observación.
	
	Por nuestra definición del conjunto de relaciones $R$ teníamos que para todo $t_{i}, t_{j}, t_{k} \in T, a_{l} \in A$ existían $u_{il}, z_{ijk} \in F$ de manera que 
	$t_j a_l = u_{il} t_j $ y que $ t_it_j = z_{ijk}t_k $. 
	Sea entonces el conjunto finito 
	\[
	U =  \{u_{il} : 1 \le i \le m, \ 1 \le l \le n \}  \cup  \{z_{ijk} : 1 \le i,j,k \le m\} 
	\]
	donde tomamos la escritura de todas las palabras en $U$ para que sean reducidas.
	Sea $B = A \cup A^{-1}$ el conjunto simétrico de generadores.
	Consideremos 
	\[
	\text{Pre}(U) = \{ u \in B^* : \exists v \in B^*, \  uv \in U  \}
	\]
	el conjunto de los prefijos de las palabras en $U$  tal que es un conjunto finito también.
	El \emph{\APD de Muller--Schupp } está definido por 
	\[
	{\cal M }= (Q, W , B \cup \{ 1 \}, \delta, (1,1,1), 1 ,\{(1,1,1)\}).
	\]
	Donde $Q = T \times (T \cup A) \times \text{Pre}(U)$.
	El alfabeto de entrada es $W$ que es el conjunto de generadores del grupo.
	El alfabeto de la pila es $B \cup 1$ que es el conjunto simétrico de generadores del subgrupo libre $F$.
	Nuestro estado inicial que también es el final corresponde a $(1,1,1)$.

	Ahora podemos definir la función de transición. 
	Sea $w_i \in W$ algún generador del grupo luego tenemos que
	\[
	\delta(w_i,(t_j,1,1), s) =
	\begin{cases}
		((t_j,a_i,1), s) \quad \text{si} \ w_{i}=a_{i} \\
		((t_k,t_i,1), s) \quad \text{si} \ w_{i}=t_{i} \ \text{y} \ t_{j}t_{i} = t_{k}
	\end{cases}\]
	de manera que si estamos en $T \times \{ 1 \} \times \{ 1 \}$ podemos pasar a la segunda coordenada correspondiente a la letra de $W$ que hayamos leído.	
	Ahora en esta instancia lo que vamos a hacer es la reducción, una letra a la vez, del producto de $u_{kj} \cdot v$ en el caso del estado $(t_k,a_i,1)$ o bien el de $z_{ijk} \cdot v$ en el caso del estado $(t_k,t_i,1)$.
	Sea entonces $v \in U$ la palabra correspondiente al estado $(t_{j},w_{i},1)$, es decir que si $w_{i} = a_{i}$ entonces $v = u_{ij}$ mientras que si $w_{i} = t_{i}$ entonces $v = z_{ijk}$. 
	En este caso obtenemos:
	\begin{equation*}
		\delta(\epsilon,(t_j,w_i,u), s) = ((t_j,w_i,u a_i), a_{i} \cdot s) \quad \ \text{si} \ ua_{i} \in \text{Pre}(v).
	\end{equation*}
	siempre y cuando $ua_i$ sea un prefijo de la palabra de $U$ correspondiente.
	La notación $v \cdot a_{i}$ representa el producto de $v \in F$ con $a_{i}$ un generador en $F$.
	Notemos que para cada configuración del tipo $(w,(t_{j}, w_{i}, u),s)$ existe una única transición posible dado que fijamos de antemano alguna escritura única en los generadores $A$ para cada palabra $u \in U$.
	Finalmente la función de transición la definimos para que podamos volver una vez que ya reducimos toda la palabra $v \in U$.
	Para eso tenemos 
	\begin{equation*}
		\delta(\epsilon,(t_j,w_i,v), s) = ((t_j,1,1), s) \quad \ \text{si} \ v \in U.		
	\end{equation*}	
	Notemos que por como lo definimos resulta ser un autómata de pila determinístico.


	Vamos a probar una propiedad importante que cumple este autómata.
	\begin{lema}\label{lema_MuSc_invariante}
	Sea $\cal M$ el \APD de Muller--Schupp, $w \in W^*$ tal que $ w = uv $ entonces si consideramos una configuración de la pinta
		\[
			(uv,(1,1,1), 1) \overset{*}{\vdash} (v, (t_{k},1,1), s^R)
		\]
		vale que $u = st_{k}$.
	\end{lema}
	
	\begin{proof}
		Lo probamos por inducción.
		En el caso base $|u| = 1$.
		Separamos en dos subcasos. 
		En el primer subcaso $u = a_{i} \in B$.
		\[
		(a_{i}v, ( 1,1,1), 1 ) \vdash (v, (1,a_{i},1),1) \vdash (v,(1,a_{i},a_{i}),a_{i}) \vdash (v, (1,1,1), a_{i})
		\]
		tal que $1 \cdot a_{i} = a_{i}$ tal como queríamos ver.
		El otro subcaso corresponde a que $u = t_{j} \in T$.
		\[
		(t_{i}v, (1,1,1), 1) \vdash (v, (t_{i},t_{i},1),1) \vdash (v,(t_{i},t_{i},1),1) \vdash (v, (t_{i},1,1), 1)
		\]
		donde usamos que $z_{1i1} = 1$ y cumple que $t_{i} \cdot 1 = t_{i}$ tal como queríamos ver.
		El paso inductivo es idéntico al caso base.
	\end{proof}
	
	
	Intuitivamente el autómata de Muller--Schupp formaliza el procedimiento que empleamos en la observación \ref{obs_presentacion_vl} para transformar una palabra $w \in W^*$ en $w = st$ con $s \in F, t \in T$.
	
	Ya estamos en condiciones de probar el resultado central de este capítulo.

\begin{teo}\label{teo_Muller_Schupp}\cite{muller1983groups}
	Todo grupo virtualmente libre es independiente de contexto.
\end{teo}

\begin{proof}
	Para probar que es \ic vamos a probar que el \APD de Muller--Schupp $\cal M$ cumple que $L({\cal M})= \text{WP}(G,W)$.
	Consideremos ahora el lenguaje aceptado por estado final y por palabra en la pila $1$:
	\[
	{\cal L }(M) = \{  w \in W^* \mid (w,(1,1,1),1)   \vdash^*  (\epsilon, (1,1,1), 1)  \}.
	\]
	Debemos ver que el autómata acepta justamente al lenguaje que queremos. 
	Esto es que $ {\cal L }(M) = \text{WP}(G,W) $ 
	
	Si $w \in L(\cal M)$ entonces $(w, (1,1,1), 1) \overset{*}{\vdash} (\epsilon, (1,1,1), 1)$ y por lo tanto por el lema \ref{lema_MuSc_invariante} obtenemos que $w = 1$ y así que $w \in \text{WP}(G,W)$.
	
	Si $w \in \text{WP}(G,W)$ entonces $w = 1$ en $G$ por lo que nuevamente usando el lema \ref{lema_MuSc_invariante} obtenemos que $(w, (1,1,1), 1) \overset{*}{\vdash} (\epsilon, (t_{i},1,1), s)$
	y esto implica que $t_{i}s = 1$ por lo que $t_{i} = 1, s =1$ y así $w \in L(\cal M)$.
	
	
	Con esto probamos que los grupos virtualmente libres son \ic usando la equivalencia \ref{teo_ic_apnd}.
	
\end{proof}

Siendo más precisos probamos algo más fuerte que lo enunciado en el teorema.
A saber, los lenguajes que son el problema de la palabra de un grupo virtualmente libre son lenguajes determinísticos independientes de contexto especiales.



\end{document}

